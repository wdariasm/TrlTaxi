app.service("contratoService",["$http",function(o){this.get=function(t){var e=o.get(uri+"/api/contrato/"+t);return e},this.getByCliente=function(t){var e=o.get(uri+"/api/cliente/"+t+"/contratos");return e},this.getPorNumeroCto=function(t){var e=o.get(uri+"/api/contrato/"+t+"/tiposervicio");return e}}]),app.service("usuarioService",["$http",function(o){this.get=function(t){var e=o.get(uri+"/api/usuario/"+t);return e},this.put=function(t,e){var i=o.put(uri+"/api/usuario/"+t,e);return i},this.udpatePass=function(t,e){var i=o.put(uri+"/api/usuario/updatePassword/"+t,e);return i},this.cerrarSesion=function(t){var e=o.delete(uri+"/api/usuario/"+t+"/cerrar");return e}}]),app.service("zonaService",["$http",function(o){this.get=function(t){var e=o.get(uri+"/api/zona/"+t);return e},this.getPuntos=function(t){var e=o.get(uri+"/api/zona/"+t+"/puntos");return e},this.getNumTaxi=function(t){var e=o.get(uri+"/api/zona/"+t+"/taxis");return e},this.getTaxistas=function(t){var e=o.get(uri+"/api/zona/"+t+"/taxistas");return e},this.getAll=function(){var t=o.get(uri+"/api/zona");return t},this.getByNombre=function(){var t=o.get(uri+"/api/zonas");return t}}]),app.controller("homeController",["$scope",function(o){function t(){o.Login=session.getUser()}o.Titulo="BIENVENIDOS",o.Login={};var e=1;o.mostrarOcultarMenu=function(){if(1===e){document.getElementById("cont-menu").className="menuLeft";var o=document.getElementById("contenido");o.classList.remove("contenido-normal"),o.classList.add("contenido-expandido"),e+=1}else{var o=document.getElementById("contenido");o.classList.remove("contenido-expandido"),o.classList.add("contenido-normal"),document.getElementById("cont-menu").className="menuRight",e=1}},o.SetTitulo=function(t){o.Titulo=t},t()}]),app.controller("salirController",["$scope","usuarioService","toaster",function(o,t,e){function i(){var i=t.cerrarSesion(o.$parent.Login.IdUsuario);i.then(function(t){sessionStorage.setItem("usuario",""),sessionStorage.removeItem("usuario"),o.mensaje="Su sesión ha finalizado correctamente",e.pop("success","¡Información!","Su sesión ha terminado."),setTimeout('location.href = "../inicio/index.html#/login"',3e3)},function(o){e.pop("error","¡Error!",o.data.request),console.log("failure loading usuarios",o)})}o.$parent.SetTitulo("CERRANDO SESIÓN"),o.mensaje="Cerrando sesión ....",i()}]),app.controller("serviciosController",["$scope","zonaService","ngTableParams","toaster","contratoService",function(o,t,e,i,n){function r(){o.Servicio={Origen:"",Destino:"",ContratoId:0,NumeroContrato:"",ClienteId:0,Nit:"",Nombre:"",Telefono:"",TipoServicio:[],FechaInicio:"",FechaFin:"",Estado:"",Tipo:{},Responsable:""}}function a(){for(var t=[],e=0;e<o.vecPoligono.length;e++)t.push(o.vecPoligono[e].coordenadas);null!==o.poly&&o.poly.setMap(null),o.poly=new google.maps.Polygon({paths:t,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25}),o.poly.setMap(o.mapServicio)}o.Zonas=[],o.Zona={},o.Contratos=[],o.ContratoSelect={},o.Boton={Cargando:!0},o.$parent.SetTitulo("SOLICITAR SERVICIOS"),o.Servicio={},o.Puntos=[],o.editMode=!1,o.mapServicio,o.markerOrigen=null;o.vecPoligono=new Array,o.poly=null,o.tbZona={},o.title="Nuevo Servicio",o.Posicion={Latitud:10.4370725,Longitud:-75.524795},o.$parent.SetTitulo("GESTIÓN DE SERVICIOS"),o.AutocompleteOrigen=null,o.AutocompleteDestino=null,r(),o.eliminarUltimoPunto=function(){o.vecPoligono.length>0&&(o.vecPoligono[o.vecPoligono.length-1].marcador.setMap(null),o.vecPoligono.pop(),a())},o.nuevo=function(){o.editMode=!1,o.title="NUEVA ZONA"},o.get=function(t){o.editMode=!0,o.title="EDITAR ZONA",o.Zona=t,getPuntos(t.znCodigo)},o.BuscarContrato=function(t){o.Servicio.ContratoId=0;var e="";if("COMBO"===t)e=o.ContratoSelect.ctNumeroContrato;else{if(!o.Servicio.NumeroContrato)return void i.pop("info","Estimado usuario(a), por favor ingrese el número de contrato");e=o.Servicio.NumeroContrato}i.pop("wait","Consulta","Consultando informacioón....",0),o.Servicio.Tipo=[];var r=n.getPorNumeroCto(e);r.then(function(t){t.data?(i.clear(),o.Servicio.ContratoId=t.data.IdContrato,o.Servicio.Nombre=t.data.ctContratante,o.Servicio.ClienteId=t.data.ctClienteId,o.Servicio.Nit=t.data.ctNitCliente,o.Servicio.Telefono=t.data.ctTelefono,o.Servicio.FechaFin=new Date(t.data.ctFechaFinal).toLocaleDateString("en-GB"),o.Servicio.FechaInicio=new Date(t.data.ctFechaInicio).toLocaleDateString("en-GB"),o.Servicio.Estado=t.data.ctEstado,o.Servicio.TipoServicio=t.data.TipoServicio,0===o.Servicio.TipoServicio&&i.pop("error","No se encontraón servicios asociados a este contrato",0)):i.pop("error","Número de contrato no existe")},function(o){i.pop("error","¡Error!",o,0),console.log("Some Error Occured "+JSON.stringify(o))})},o.TipoServicioCheck=function(t){console.log(o.Servicio.Tipo),"SI"===o.Servicio.Tipo.csPlantilla?(o.titlePlantilla="Plantillas "+o.Servicio.Tipo.csDescripcion,o.VerPlantilla=!0):(o.titlePlantilla="Dispobilidad ",o.VerPlantilla=!1)},o.GetContratos=function(){var t=n.getByCliente(1);t.then(function(t){o.Contratos=t.data},function(o){i.pop("error","¡Error!","Error al cargar contratos"),console.log("Some Error Occured "+JSON.stringify(o))})},o.GetContratos()}]);