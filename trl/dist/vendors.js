app.service("bancoService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/banco/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/banco");return e},this.post=function(e){var r=o.post(uri+"/api/banco",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/banco/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/bancos");return e},this.getFranquicia=function(e){var r=o.get(uri+"/api/franquicia/"+e);return r},this.getAllFranquicia=function(){var e=o.get(uri+"/api/franquicia");return e},this.postFranquicia=function(e){var r=o.post(uri+"/api/franquicia",e);return r},this.putFranquicia=function(e,r){var t=o.put(uri+"/api/franquicia/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/franquicia/updateEstado/"+e,r);return t}}]),app.service("clienteService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/cliente/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/cliente");return e},this.post=function(e){var r=o.post(uri+"/api/cliente",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/cliente/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/cliente/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/clientes");return e},this.validarIdentificacion=function(e){var r=o.get(uri+"/api/cliente/"+e+"/validar");return r}}]),app.service("conductorService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/conductor/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/conductor");return e},this.post=function(e){var r=o.post(uri+"/api/conductor",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/conductor/"+e,r);return t},this.postNovedad=function(e){var r=o.post(uri+"/api/conductor/novedad",e);return r},this.putNovedad=function(e,r){var t=o.put(uri+"/api/conductor/novedad/"+e,r);return t},this.postLicencia=function(e){var r=o.post(uri+"/api/conductor/licenciaConduccion",e);return r},this.putLicencia=function(e,r){var t=o.put(uri+"/api/conductor/licenciaConduccion/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/conductor/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/conductores");return e},this.validarIdentificacion=function(e){var r=o.get(uri+"/api/conductor/"+e+"/validar");return r},this.getNovedad=function(e){var r=o.get(uri+"/api/conductor/"+e+"/novedades");return r},this.getLicencia=function(e){var r=o.get(uri+"/api/conductor/"+e+"/licencias");return r},this.validarNumero=function(e){var r=o.get(uri+"/api/licenciaConduccion/"+e+"/validar");return r},this.updateEstadoLicencia=function(e,r){var t=o.put(uri+"/api/licenciaConduccion/updateEstado/"+e,r);return t}}]),app.service("contratoService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/contrato/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/contrato");return e},this.post=function(e){var r=o.post(uri+"/api/contrato",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/contrato/"+e,r);return t}}]),app.service("departamentoService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/departamento/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/departamento");return e},this.post=function(e){var r=o.post(uri+"/api/departamento",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/departamento/"+e,r);return t},this.getMunicipios=function(e){var r=o.get(uri+"/api/departamento/"+e+" /municipios");return r}}]),app.service("disponibilidadService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/disponibilidad/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/disponibilidad");return e},this.post=function(e){var r=o.post(uri+"/api/disponibilidad",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/disponibilidad/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/disponibilidad/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/disponibilidades");return e}}]),app.service("encuestaService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/encuesta/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/encuesta");return e},this.post=function(e){var r=o.post(uri+"/api/encuesta",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/encuesta/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/encuesta/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/encuestas");return e}}]),app.service("escolaridadService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/escolaridad/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/escolaridad");return e},this.post=function(e){var r=o.post(uri+"/api/escolaridad",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/escolaridad/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/escolaridad/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/escolaridades");return e},this.validarCodigo=function(e){var r=o.get(uri+"/api/escolaridad/"+e+"/validar");return r}}]),app.service("marcaService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/marca/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/marca");return e},this.post=function(e){var r=o.post(uri+"/api/marca",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/marca/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/marca/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/marcas");return e}}]),app.service("novedadService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/novedad/"+e);return r},this.post=function(e){var r=o.post(uri+"/api/novedad",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/novedad/"+e,r);return t}}]),app.service("perfilService",function(o){this.get=function(e){var r=o.get(uri+"/api/perfil/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/perfil");return e},this.getActivos=function(){var e=o.get(uri+"/api/perfil/estado");return e},this.getPermisoByPerfil=function(e){var r=o.get(uri+"/api/perfil/"+e+"/permisos");return r},this.post=function(e){var r=o.post(uri+"/api/perfil",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/perfil/"+e,r);return t},this.delete=function(e){var r=o.delete(uri+"/api/perfil/"+e);return r},this.getPermisos=function(){var e=o.get(uri+"/api/permisos");return e}}),app.service("personaService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/persona/"+e);return r},this.validar=function(e){var r=o.get(uri+"/api/persona/"+e+"/validar");return r},this.getAll=function(){var e=o.get(uri+"/api/persona");return e},this.post=function(e){var r=o.post(uri+"/api/persona",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/persona/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/persona/updateEstado/"+e,r);return t}}]),app.service("rutaService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/ruta/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/ruta");return e},this.post=function(e){var r=o.post(uri+"/api/ruta",e);return r},this.postImagen=function(e){var r=o.post(uri+"/api/ruta/imagen",e,{transformRequest:angular.identity,headers:{"Content-Type":void 0}});return r},this.put=function(e,r){var t=o.put(uri+"/api/ruta/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/ruta/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/rutas");return e}}]),app.service("tipoDocumentoService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/tipoDocumento/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/tipoDocumento");return e},this.post=function(e){var r=o.post(uri+"/api/tipoDocumento",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/tipoDocumento/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/tipoDocumento/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/tipoDocumentos");return e}}]),app.service("tipoMantenimientoService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/tipoMantenimiento/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/tipoMantenimiento");return e},this.post=function(e){var r=o.post(uri+"/api/tipoMantenimiento",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/tipoMantenimiento/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/tipoMantenimiento/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/tipoMantenimientos");return e}}]),app.service("tiposervicioService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/tiposervicio/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/tiposervicio");return e},this.post=function(e){var r=o.post(uri+"/api/tiposervicio",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/tiposervicio/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/tiposervicio/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/servicios");return e}}]),app.service("tipoVehiculoService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/tipoVehiculo/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/tipoVehiculo");return e},this.post=function(e){var r=o.post(uri+"/api/tipoVehiculo",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/tipoVehiculo/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/tipoVehiculo/updateEstado/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/tipoVehiculos");return e}}]),app.service("transfertService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/transfert/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/transfert");return e},this.post=function(e){var r=o.post(uri+"/api/transfert",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/transfert/"+e,r);return t},this.delete=function(e,r){var t=o.delete(uri+"/api/transfert/"+e,r);return t},this.getActivos=function(){var e=o.get(uri+"/api/transferts");return e},this.updateEstado=function(e,r){var t=o.put(uri+"/api/transfert/updateEstado/"+e,r);return t}}]),app.service("usuarioService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/usuario/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/usuario");return e},this.post=function(e){var r=o.post(uri+"/api/usuario",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/usuario/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/usuario/updateEstado/"+e,r);return t},this.udpatePass=function(e,r){var t=o.put(uri+"/api/usuario/updatePassword/"+e,r);return t},this.cerrarSesion=function(e){var r=o.delete(uri+"/api/usuario/"+e+"/cerrar");return r},this.getPermisos=function(e){var r=o.get(uri+"/api/usuario/"+e+"/permisos");return r},this.validar=function(e){var r=o.get(uri+"/api/usuario/"+e+"/validar");return r}}]),app.service("vehiculoService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/vehiculo/"+e);return r},this.getAll=function(){var e=o.get(uri+"/api/vehiculo");return e},this.getNovedad=function(e){var r=o.get(uri+"/api/vehiculo/"+e+"/novedades");return r},this.post=function(e){var r=o.post(uri+"/api/vehiculo",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/vehiculo/"+e,r);return t},this.updateEstado=function(e,r){var t=o.put(uri+"/api/vehiculo/updateEstado/"+e,r);return t},this.validarPlaca=function(e){var r=o.get(uri+"/api/vehiculo/"+e+"/validar");return r}}]),app.service("zonaService",["$http",function(o){this.get=function(e){var r=o.get(uri+"/api/zona/"+e);return r},this.getPuntos=function(e){var r=o.get(uri+"/api/zona/"+e+"/puntos");return r},this.getNumTaxi=function(e){var r=o.get(uri+"/api/zona/"+e+"/taxis");return r},this.getTaxistas=function(e){var r=o.get(uri+"/api/zona/"+e+"/taxistas");return r},this.getAll=function(){var e=o.get(uri+"/api/zona");return e},this.post=function(e){var r=o.post(uri+"/api/zona",e);return r},this.put=function(e,r){var t=o.put(uri+"/api/zona/"+e,r);return t},this.delete=function(e,r){var t=o.delete(uri+"/api/zona/"+e,r);return t},this.getByNombre=function(){var e=o.get(uri+"/api/zonas");return e}}]),app.controller("bancoController",["$scope","bancoService","toaster","ngTableParams",function(o,e,r,t){function i(){o.Banco={bcCodigo:"",bcNombre:""}}function n(){var t=e.getAll();t.then(function(e){o.Bancos=e.data,o.TablaBanco.reload()},function(o){r.pop("error","¡Error!","Error al cargar Bancos"),console.log("Some Error Occured "+JSON.stringify(o))})}function a(){o.TablaBanco=new t({page:1,count:10,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Bancos.filter(function(o){return o.bcCodigo.toLowerCase().indexOf(t)>-1||o.bcNombre.toLowerCase().indexOf(t)>-1})):f=o.Bancos,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}function c(){o.Franquicia={frCodigo:"",frDescripcion:"",frEstado:"ACTIVO"}}function s(){var t=e.getAllFranquicia();t.then(function(e){o.Franquicias=e.data,o.TablaFranquicia.reload()},function(o){r.pop("error","Error","No se pudo cargar franquicias"),console.log("Some Error Occured "+JSON.stringify(o))})}function u(){o.TablaFranquicia=new t({page:1,count:10,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Franquicias.filter(function(o){return o.frDescripcion.toLowerCase().indexOf(t)>-1||o.frEstado.toLowerCase().indexOf(t)>-1})):f=o.Franquicias,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}o.Banco={},o.Bancos=[],o.Franquicia={},o.Franquicias=[],o.title="Nuevo Banco",o.Titulo="Nueva Franquicia",o.IdFranquiciaGlobal="",o.TablaBanco={},o.TablaFranquicia={},o.editMode=!1,o.editFranquicia=!1,o.$parent.SetTitulo("GESTION DE BANCO Y FRANQUICIAS"),i(),c(),a(),o.GuardarBanco=function(){o.Banco.bcNombre=o.Banco.bcNombre.toUpperCase();var t;t=o.editMode?e.put(o.Banco.bcCodigo,o.Banco):e.post(o.Banco),t.then(function(o){n(),r.pop("success","Control de Información",o.data.message)},function(o){r.pop("error","Error","Error al guardar Banco"),console.log("Some Error Occured "+JSON.stringify(o))})},o.getBanco=function(e){o.Banco=e,o.editMode=!0,o.title="Editar Banco",o.active="active"},o.NuevoBanco=function(){i(),o.editMode=!1,o.title="Nuevo Banco"},o.NuevaFranquicia=function(){c(),o.editFranquicia=!1,o.Titulo="Nueva Franquicia"},o.getFranquicia=function(e){o.Franquicia=e,o.Titulo="Editar Franquicia",o.editFranquicia=!0,o.active="active"},o.GuardarFranquicia=function(){o.Franquicia.frDescripcion=o.Franquicia.frDescripcion.toUpperCase();var t;t=o.editFranquicia?e.putFranquicia(o.Franquicia.frCodigo,o.Franquicia):e.postFranquicia(o.Franquicia),t.then(function(o){s(),c(),r.pop("success","Control de Información",o.data.message)},function(o){r.pop("error","Error","Error al guardar Franquicia"),console.log("Some Error Occured "+JSON.stringify(o))})},o.VerDesactivarFranq=function(e,r){o.frEstado=r,o.frCodigo=e,$("#mdConfirmacion").modal("show")},o.DesactivarFranq=function(){var t={frEstado:o.frEstado};$("#mdConfirmacion").modal("hide");var i=e.updateEstado(o.frCodigo,t);i.then(function(o){r.pop("success","Control de Información",o.data.message),s()},function(o){r.pop("error","Error","Error al procesar Solicitud"),console.log("Some Error Occured "+JSON.stringify(o))})},u(),s(),n()}]),app.controller("clienteController",["$scope","clienteService","tipoDocumentoService","toaster","ngTableParams",function(o,e,r,t,i){function n(){o.Cliente={IdCliente:"",Identificacion:"",Nombres:"",Direccion:"",MovilPpal:"",MovilDos:"",MovilTres:"",Correo:"",Estado:"ACTIVO",TipoPersona:"NATURAL",DigitoVerificacion:"",TipoDocumento:""}}function a(){var r=e.getAll();r.then(function(e){o.Clientes=e.data,o.TablaCliente.reload(),e.data&&(o.TipoSelect=e.data[0])},function(o){t.pop("error","¡Error!","Error al cargar Clientes"),console.log("Some Error Occured "+JSON.stringify(o))})}function c(){var e=r.getAll();e.then(function(e){o.TipoDocumentos=e.data},function(o){t.pop("error","¡Error!","ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})}function s(){o.TablaCliente=new i({page:1,count:10,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().filtro;f=[],t?(t=t.toLowerCase(),f=o.Clientes.filter(function(o){return o.Identificacion.toLowerCase().indexOf(t)>-1||o.Nombres.toLowerCase().indexOf(t)>-1||o.MovilPpal.toLowerCase().indexOf(t)>-1||o.Estado.toLowerCase().indexOf(t)>-1})):f=o.Clientes,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}o.Cliente={},o.Clientes=[],o.TablaCliente={},o.TipoDocumentos=[],o.title="Nuevo Cliente",o.TipoSelect={},o.IdClienteGlobal="",o.valIdent=!1,o.editMode=!1,o.$parent.SetTitulo("GESTION DE CLIENTE"),o.Nuevo=function(){n(),o.editMode=!1,o.title="Nuevo Cliente"},n(),c(),s(),o.Guardar=function(){if(o.Cliente.Nombres=o.Cliente.Nombres.toUpperCase(),o.Cliente.Estado=o.Cliente.Estado.toUpperCase(),o.Cliente.Direccion=o.Cliente.Direccion.toUpperCase(),o.Cliente.DigitoVerificacion=o.Cliente.DigitoVerificacion.toUpperCase(),o.Cliente.TipoPersona=o.Cliente.TipoPersona.toUpperCase(),o.Cliente.TipoDocumento=o.TipoSelect.tdCodigo,o.valIdent)return void t.pop("error","¡Error!","N° de Cedula ya existe");var r;r=o.editMode?e.put(o.Cliente.IdCliente,o.Cliente):e.post(o.Cliente),r.then(function(o){a(),t.pop("success","Control de Información",o.data.message)},function(o){t.pop("error","Error","ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})},o.get=function(e){o.Cliente=e,o.editMode=!0,o.title="Editar Cliente",o.active="active",console.log(e),$('#tabPanels a[href="#tabRegistro"]').tab("show")},o.VerDesactivar=function(e,r){o.Estado=r,o.IdClienteGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var r={Estado:o.Estado};$("#mdConfirmacion").modal("hide");var i=e.updateEstado(o.IdClienteGlobal,r);i.then(function(o){t.pop("success","Control de Información",o.data.message),a()},function(o){t.pop("error","Error","ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})},o.validarIdentificacion=function(){if(o.valIdent=!1,o.Cliente.Identificacion){var r=e.validarIdentificacion(o.Cliente.Identificacion);r.then(function(e){e.data.Identificacion&&(o.valIdent=!0,t.pop("info","N° de Identificación ya existe"))},function(o){t.pop("error","Error","Error al validar Identificación"),console.log("Some Error Occured "+JSON.stringify(o))})}},a()}]),app.controller("conductorController",["$scope","conductorService","tipoDocumentoService","escolaridadService","toaster","ngTableParams","vehiculoService",function(o,e,r,t,i,n,a){function c(){o.Conductor={IdConductor:"",Cedula:"",Nombre:"",Direccion:"",TelefonoPpal:"",TelefonoDos:"",TelefonoTres:"",Email:"",FechaNacimiento:"",FechaIngreso:moment().format("L"),Estado:"ACTIVO",FechaReg:"",NumeroCuenta:"",CdPlaca:"",Observacion:"",TipoDocumento:"",Escolaridad:""}}function s(){var r=e.getAll();r.then(function(e){o.Conductores=e.data,o.TablaConductor.reload()},function(o){i.pop("error","¡Error!","Error al cargar Conductores"),console.log("Some Error Occured "+JSON.stringify(o))})}function u(){var e=t.getAll();e.then(function(e){o.Escolaridades=e.data},function(o){i.pop("error","¡Error!","Error al cargar Escolaridad"),console.log("Some Error Occured "+JSON.stringify(o))})}function d(){var e=r.getAll();e.then(function(e){o.TipoDocumentos=e.data},function(o){i.pop("error","¡Error!","Error al cargar Tipo Documento"),console.log("Some Error Occured "+JSON.stringify(o))})}function l(){o.TablaConductor=new n({page:1,count:10,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Conductores.filter(function(o){return o.Cedula.toLowerCase().indexOf(t)>-1||o.Nombre.toLowerCase().indexOf(t)>-1||o.TelefonoPpal.toLowerCase().indexOf(t)>-1||o.Estado.toLowerCase().indexOf(t)>-1})):f=o.Conductores,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}function p(){o.Novedad={nvDescripcion:"",nvTipo:"CONTRALORIA"}}function g(r){var t=e.getNovedad(r);t.then(function(e){o.Novedades=e.data},function(o){i.pop("error","Error","No se pudo procesar la solicitud"),console.log("Some Error Occured "+JSON.stringify(o))})}function v(){o.LicenciaConduccion={IdLicencia:"",Numero:"",OTLicencia:"",FechaExpedicion:moment().format("L"),FechaVencimiento:moment().format("L"),Estado:"ACTIVA",Categoria:"C1",FechaReg:"",lcConductor:""}}function m(r){var t=e.getLicencia(r);t.then(function(e){o.Licencias=e.data},function(o){i.pop("error","Error","No se pudo procesar la solicitud"),console.log("Some Error Occured "+JSON.stringify(o))})}o.Conductor={},o.Conductores=[],o.Novedad={},o.Novedades=[],o.TipoDocumentos=[],o.Escolaridades=[],o.LicenciaConduccion={},o.Licencias=[],o.valCedula=!1,o.valNumero=!1,o.title="Registro Conductor",o.IdConductorGlobal="",o.IdLicenciaG="",o.TablaConductor={},o.TablaNovedad={},o.editMode=!1,o.editNovedad=!1,o.$parent.SetTitulo("GESTION DE CONDUCTOR"),c(),p(),v(),o.Cambiarformato=function(e){console.log(e),o.Conductor[e]=moment(o.Conductor[e]).format("L")},u(),d(),l(),o.Guardar=function(){if(o.Conductor.Nombre=o.Conductor.Nombre.toUpperCase(),o.Conductor.Direccion=o.Conductor.Direccion.toUpperCase(),o.Conductor.Observacion=o.Conductor.Observacion.toUpperCase(),o.Conductor.Escolaridad=o.Conductor.Escolaridad.toUpperCase(),o.Conductor.CdPlaca=o.Conductor.CdPlaca.toUpperCase(),o.valCedula)return void i.pop("error","¡Error!","N° de Cedula ya existe");if(o.valPlaca)return void i.pop("error","¡Error!","Placa no se encuentra registrada");var r;o.editMode?r=e.put(o.Conductor.IdConductor,o.Conductor):(o.Conductor.Novedades=o.Novedades,r=e.post(o.Conductor)),r.then(function(o){s(),i.pop("success","Control de Información",o.data.message)},function(o){i.pop("error","Error","Error al guardar Conductor"),console.log("Some Error Occured "+JSON.stringify(o))})},o.get=function(e){o.Conductor=e,o.Conductor.FechaNacimiento=moment(o.Conductor.FechaNacimiento).format("L"),o.Conductor.FechaIngreso=moment(o.Conductor.FechaIngreso).format("L"),o.editMode=!0,o.title="Editar Conductor",o.active="active",$('#tabPanels a[href="#tabRegistro"]').tab("show"),g(e.IdConductor)},o.AgregarNovedad=function(){return o.Novedad.nvTipo?o.Novedad.nvDescripcion?(o.Novedad.nvDescripcion=o.Novedad.nvDescripcion.toUpperCase(),o.Novedades.push(o.Novedad),void(o.Novedad={})):void i.pop("warning","Ingresa la descripcion"):void i.pop("warning","Ingresa el tipo")},o.Nuevo=function(){c(),p(),o.editMode=!1,o.title="Nuevo Conductor"},o.getNovedad=function(e){o.Novedad=e,o.editNovedad=!0,o.active="active"},o.VerDesactivar=function(e,r){o.Estado=r,o.IdConductorGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var r={Estado:o.Estado};$("#mdConfirmacion").modal("hide");var t=e.updateEstado(o.IdConductorGlobal,r);t.then(function(o){i.pop("success","Control de Información",o.data.message),s()},function(o){i.pop("error","Error","Error al descativar Conductor"),console.log("Some Error Occured "+JSON.stringify(o))})},o.validarIdentificacion=function(){if(o.valCedula=!1,o.Conductor.Cedula){var r=e.validarIdentificacion(o.Conductor.Cedula);r.then(function(e){e.data.Cedula&&(o.valCedula=!0,i.pop("info","N° de Identificación ya existe"))},function(o){i.pop("error","Error","Error al validar Identificación"),console.log("Some Error Occured "+JSON.stringify(o))})}},o.GuardarNovedad=function(){if(!o.Novedad.nvTipo)return void i.pop("warning","Ingresa el tipo");if(!o.Novedad.nvDescripcion)return void i.pop("warning","Ingresa la descripción");o.Novedad.nvDescripcion=o.Novedad.nvDescripcion.toUpperCase(),o.Novedad.nvConductor=o.Conductor.IdConductor;var r;r=o.editNovedad?e.putNovedad(o.Novedad.nvCodigo,o.Novedad):e.postNovedad(o.Novedad),r.then(function(e){g(o.Conductor.IdConductor),i.pop("success","Control de Información",e.data.message)},function(o){i.pop("error","Error","ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})},o.ValidarPlaca=function(){if(o.valPlaca=!1,o.Conductor.CdPlaca&&!o.editMode){var e=a.validarPlaca(o.Conductor.CdPlaca);e.then(function(e){e.data.Placa||(o.valPlaca=!0,i.pop("info","¡Alerta!","Esta placa no existe"))},function(o){i.pop("error","¡Error!","Error al validar placa."),console.log("Some Error Occured "+JSON.stringify(o))})}},o.getLicencia=function(e){o.LicenciaConduccion=e,o.editMode=!0,o.active="active"},o.GuardarLicencia=function(){if(!o.LicenciaConduccion.Numero)return void i.pop("warning","Ingresa el Numero");if(!o.LicenciaConduccion.OTLicencia)return void i.pop("warning","Ingresa el O.T Licencia");if(!o.LicenciaConduccion.Categoria)return void i.pop("warning","Ingresa La Categoria");if(!o.Conductor.IdConductor)return void i.pop("warning","Validación","No existe un conductor seleccionado");if(o.valNumero)return void i.pop("error","¡Error!","N° de licencia ya existe");o.LicenciaConduccion.lcConductor=o.Conductor.IdConductor,o.LicenciaConduccion.OTLicencia=o.LicenciaConduccion.OTLicencia.toUpperCase(),o.LicenciaConduccion.Categoria=o.LicenciaConduccion.Categoria.toUpperCase();var r;r=o.editMode?e.putLicencia(o.LicenciaConduccion.IdLicencia,o.LicenciaConduccion):e.postLicencia(o.LicenciaConduccion),r.then(function(e){m(o.Conductor.IdConductor),v(),i.pop("success","Control de Información",e.data.message)},function(o){i.pop("error","Error","ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})},o.formatoLicencia=function(e){console.log(e),o.LicenciaConduccion[e]=moment(o.LicenciaConduccion[e]).format("L")},o.AgregarLicencia=function(e){o.Conductor=e,m(e.IdConductor),v(),o.LicenciaConduccion.lcConductor=e.IdConductor,o.LicenciaConduccion.Identificacion=e.Cedula,$('#tabPanels a[href="#tabLicencia"]').tab("show")},o.validarNumero=function(){if(o.valNumero=!1,o.LicenciaConduccion.Numero){var r=e.validarNumero(o.LicenciaConduccion.Numero);r.then(function(e){e.data.Numero&&(o.valNumero=!0,i.pop("info","Licencia!!","N° de licencia ya existe"))},function(o){i.pop("error","Error","Error al validar Número de Licencia"),console.log("Some Error Occured "+JSON.stringify(o))})}},o.VerDesactivarLicencia=function(e,r){o.Estado=r,o.IdLicenciaG=e,$("#mdConfirmacion").modal("show")},o.DesactivarLicencia=function(){var r={Estado:o.Estado};$("#mdConfirmacion").modal("hide");var t=e.updateEstadoLicencia(o.IdLicenciaG,r);t.then(function(o){i.pop("success","Control de Información",o.data.message),m()},function(o){i.pop("error","Error","Error al procesar Solicitud"),console.log("Some Error Occured "+JSON.stringify(o))})},s()}]),app.controller("contratoController",["$scope","tipoVehiculoService","toaster","clienteService",function(o,e,r,t){function i(){o.Contrato={ctClienteId:"",IdContrato:0,ctNitCliente:"",ctContratante:"",ctFechaInicio:moment().format("L"),ctFechaFinal:moment().format("L"),ctRazonSocial:"",ctObjeto:"",ctNitEmpresa:"",ctNumeroContrato:"",ctDuracion:"",ctNumVehiculos:"",ctUsuarReg:o.$parent.Login.Login}}o.Contrato={},o.Contatos=[],o.title="Nuevo Contrato",o.editMode=!1,i(),o.validarIdentificacion=function(){if(o.valCedula=!1,o.Cliente.Identificacion){var e=t.validarIdentificacion(o.Cliente.Identificacion);e.then(function(e){e.data.Identificacion?o.valCedula=!0:r.pop("error","Error","Cliente no registrado")},function(o){r.pop("error","Error","Error al validar Identificación"),console.log("Some Error Occured "+JSON.stringify(o))})}}}]),app.controller("disponibilidadController",["$scope","disponibilidadService","tipoVehiculoService","toaster",function(o,e,r,t){function i(){o.Disponibilidad={dpCodigo:"",dpNombre:"",dpValorHora:"",dpEstado:"ACTIVO",dpTipoVehiculo:""}}function n(){var r=e.getAll();r.then(function(e){o.Disponibilidades=e.data},function(o){t.pop("error","¡Error!","Error al cargar Disponibilidad"),console.log("Some Error Occured "+JSON.stringify(o))})}function a(){var e=r.getAll();e.then(function(e){o.TipoVehiculos=e.data,e.data&&(o.TipoSelect=e.data[0])},function(o){t.pop("error","¡Error!","Error al cargar Tipo de Vehiculo"),console.log("Some Error Occured "+JSON.stringify(o))})}o.Disponibilidad={},o.Disponibilidades=[],o.TipoVehiculos=[],o.IdDispGlobal="",o.editMode=!1,o.title="NUEVA DISPONIBILIDAD",o.TipoSelect={},o.$parent.SetTitulo("DISPONIBILIDAD"),i(),i(),a(),o.Guardar=function(){o.Disponibilidad.dpTipoVehiculo=o.TipoSelect.tvCodigo,o.Disponibilidad.dpNombre=o.Disponibilidad.dpNombre.toUpperCase();var r;r=o.editMode?e.put(o.Disponibilidad.dpCodigo,o.Disponibilidad):e.post(o.Disponibilidad),r.then(function(o){n(),t.pop("success","Control de Información",o.data.message),i()},function(o){t.pop("error","¡Error!","Error al guardar Disponibilidad"),console.log("Some Error Occured "+JSON.stringify(o))})},o.nuevo=function(){i(),o.editMode=!1,o.title="NUEVA DISPONIBILIDAD"},o.get=function(e){o.Disponibilidad=e,o.editMode=!0,o.title="EDITAR DISPONIBILIDAD",o.active="active"},o.VerDesactivar=function(e,r){o.dpEstado=r,o.IdDispGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var r={dpEstado:o.dpEstado};$("#mdConfirmacion").modal("hide");var i=e.updateEstado(o.IdDispGlobal,r);i.then(function(o){t.pop("success","Control de Información",o.data.message),n()},function(o){t.pop("error","Error","Error al Desactivar Disponibilidad"),console.log("Some Error Occured "+JSON.stringify(o))})},n()}]),app.controller("encuestaController",["$scope","encuestaService","toaster",function(o,e,r){function t(){o.Encuesta={ecDescripcion:"",ecEstado:"ACTIVO",ecCodigo:0}}function i(){var t=e.getAll();t.then(function(e){o.Encuestas=e.data},function(o){r.pop("error","¡Error!","Error al cargar encuesta"),console.log("Some Error Occured "+JSON.stringify(o))})}o.Encuesta={},o.Encuestas=[],o.IdTipoGlobal="",o.editMode=!1,o.title="Nueva Encuesta",o.$parent.SetTitulo("ENCUESTA"),t(),o.Guardar=function(){o.Encuesta.ecDescripcion=o.Encuesta.ecDescripcion.toUpperCase();var n;n=o.editMode?e.put(o.Encuesta.ecCodigo,o.Encuesta):e.post(o.Encuesta),n.then(function(o){i(),r.pop("success","Control de Información",o.data.message),t()},function(o){r.pop("error","¡Error!","Error al guardar encuesta"),console.log("Some Error Occured "+JSON.stringify(o))})},o.nuevo=function(){t(),o.editMode=!1,o.title="Nueva Encuesta"},o.get=function(e){o.Encuesta=e,o.editMode=!0,o.title="Editar Encuesta",o.active="active"},o.VerDesactivar=function(e,r){o.ecEstado=r,o.IdTipoGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={ecEstado:o.ecEstado};$("#mdConfirmacion").modal("hide");var n=e.updateEstado(o.IdTipoGlobal,t);n.then(function(o){r.pop("success","Control de Información",o.data.message),i()},function(o){r.pop("error","Error","Error al Desactivar encuesta"),console.log("Some Error Occured "+JSON.stringify(o))})},i()}]),app.controller("escolaridadController",["$scope","escolaridadService","toaster",function(o,e,r){function t(){o.Escolaridad={esCodigo:"",esDescripcion:"",esEstado:"ACTIVO"}}function i(){var t=e.getAll();t.then(function(e){o.Escolaridades=e.data},function(o){r.pop("error","¡Error!","Error al cargar Escolaridad"),console.log("Some Error Occured "+JSON.stringify(o))})}o.Escolaridad={},o.Escolaridades=[],o.IdGlobal="",o.editMode=!1,o.valCodigo=!1,o.title="NUEVA ESCOLARIDAD",o.$parent.SetTitulo("ESCOLARIDAD"),t(),o.nuevo=function(){t(),o.editMode=!1,o.title="NUEVA ESCOLARIDAD"},o.Guardar=function(){if(o.Escolaridad.esDescripcion=o.Escolaridad.esDescripcion.toUpperCase(),o.Escolaridad.esEstado=o.Escolaridad.esEstado.toUpperCase(),o.valCodigo)return void r.pop("error","¡Error!","El Codigo ya existe");var n;n=o.editMode?e.put(o.Escolaridad.esCodigo,o.Escolaridad):e.post(o.Escolaridad),
n.then(function(o){i(),r.pop("success","Control de Información",o.data.message)},function(o){r.pop("error","Error","Error al guardar Escolaridad"),console.log("Some Error Occured "+JSON.stringify(o))}),t()},o.get=function(e){o.Escolaridad=e,o.editMode=!0,o.title="EDITAR ESCOLARIDAD",o.active="active",console.log(e)},o.VerDesactivar=function(e,r){o.esEstado=r,o.IdGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={esEstado:o.esEstado};$("#mdConfirmacion").modal("hide");var n=e.updateEstado(o.IdGlobal,t);n.then(function(o){r.pop("success","Control de Información",o.data.message),i()},function(o){r.pop("error","Error","Error al desactivar Escolaridad"),console.log("Some Error Occured "+JSON.stringify(o))})},o.validarCodigo=function(){if(o.valCodigo=!1,o.Escolaridad.esCodigo){var t=e.validarCodigo(o.Escolaridad.esCodigo);t.then(function(e){e.data.esCodigo&&(o.valCodigo=!0,r.pop("info","Codigo ya existe"))},function(o){r.pop("error","Error","Error al validar el Codigo"),console.log("Some Error Occured "+JSON.stringify(o))})}},i()}]),app.controller("homeController",["$scope",function(o){function e(){o.Login=session.getUser()}o.Titulo="BIENVENIDOS",o.Login={};var r=1;o.mostrarOcultarMenu=function(){if(1===r){document.getElementById("cont-menu").className="menuLeft";var o=document.getElementById("contenido");o.classList.remove("contenido-normal"),o.classList.add("contenido-expandido"),r+=1}else{var o=document.getElementById("contenido");o.classList.remove("contenido-expandido"),o.classList.add("contenido-normal"),document.getElementById("cont-menu").className="menuRight",r=1}},o.SetTitulo=function(e){o.Titulo=e},e()}]),app.controller("salirController",["$scope","usuarioService","toaster",function(o,e,r){function t(){var t=e.cerrarSesion(o.$parent.Login.IdUsuario);t.then(function(e){sessionStorage.setItem("usuario",""),sessionStorage.removeItem("usuario"),o.mensaje="Su sesión ha finalizado correctamente",r.pop("success","¡Información!","Su sesión ha terminado."),setTimeout('location.href = "../inicio/index.html#/login"',3e3)},function(o){r.pop("error","¡Error!",o.data.request),console.log("failure loading usuarios",o)})}o.$parent.SetTitulo("CERRANDO SESIÓN"),o.mensaje="Cerrando sesión ....",t()}]),app.controller("marcaController",["$scope","marcaService","toaster",function(o,e,r){function t(){o.Marca={maDescripcion:"",maEstado:"ACTIVO"}}function i(){var t=e.getAll();t.then(function(e){o.Marcas=e.data},function(o){r.pop("error","¡Error!","Error al cargar Marcas"),console.log("Some Error Occured "+JSON.stringify(o))})}o.Marca={},o.Marcas=[],o.IdMarcaGlobal="",o.editMode=!1,o.title="NUEVA MARCA",o.$parent.SetTitulo("MARCA"),t(),o.nuevo=function(){t(),o.editMode=!1,o.title="NUEVA MARCA"},o.Guardar=function(){o.Marca.maDescripcion=o.Marca.maDescripcion.toUpperCase(),o.Marca.maEstado=o.Marca.maEstado.toUpperCase();var n;n=o.editMode?e.put(o.Marca.maCodigo,o.Marca):e.post(o.Marca),n.then(function(o){i(),r.pop("success","Control de Información",o.data.message)},function(o){r.pop("error","Error","Error al guardar Marca"),console.log("Some Error Occured "+JSON.stringify(o))}),t()},o.get=function(e){o.Marca=e,o.editMode=!0,o.title="EDITAR MARCA",o.active="active"},o.VerDesactivar=function(e,r){o.maEstado=r,o.IdMarcaGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={maEstado:o.maEstado};$("#mdConfirmacion").modal("hide");var n=e.updateEstado(o.IdMarcaGlobal,t);n.then(function(o){r.pop("success","Control de Información",o.data.message),i()},function(o){r.pop("error","Error","Error  al desactivar Marca"),console.log("Some Error Occured "+JSON.stringify(o))})},i()}]),app.controller("novedadController",["$scope","novedadService",function(o,e){function r(){var r=e.getAll();r.then(function(e){o.Novedades=e.data},function(o){alert("ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})}o.Novedad={},o.Novedades=[],o.editMode=!1,o.Guardar=function(){o.Novedad.nvDescripcion=o.Novedad.nvDescripcion.toUpperCase(),o.Novedad.nvTipo=o.Novedad.nvTipo.toUpperCase(),o.Novedad.nvEstado=o.Novedad.nvEstado.toUpperCase();var t;t=o.editMode?e.put(o.Novedad.nvCodigo,o.Novedad):e.post(o.Novedad),t.then(function(o){r(),alert(o.data.message)},function(o){alert("ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})},r()}]),app.controller("personaController",["$scope","personaService","tipoDocumentoService","perfilService","toaster","usuarioService","funcionService",function(o,e,r,t,i,n,a){function c(){o.Persona={IdPersona:"",Cedula:"",Nombre:"",Direccion:"",MovilPpal:"",MovilDos:"",Correo:"",Estado:"ACTIVO",TipoDocumento:"",Login:"",Clave:"",Permisos:[]}}function s(){var r=e.getAll();r.then(function(e){o.Personas=e.data},function(o){console.log("failure loading personal",o)})}function u(){var e=r.getAll();e.then(function(e){o.TipoDocumentos=e.data,e.data&&(o.TipoSelect=e.data[0])},function(o){i.pop("error","¡Error!","Error al cargar tipos de documento"),console.log("Some Error Occured "+JSON.stringify(o))})}function d(){var e=t.getPermisos();e.then(function(e){o.Permisos=e.data,e.data&&o.permisosByPerfil()},function(o){i.pop("error","¡Error!","Error al cargar permisos"),console.log("failure loading Paises",o)})}function l(e){o.Persona.Modulo=a.GetModuloUser(o.Persona.Permisos),e.ClienteId=null,e.ConductorId=null,e.TipoAcceso=2,e.Contrato=0;var r=n.post(e);r.then(function(e){i.pop("success","Control de información",e.data.message),o.Nuevo(),$('#tabPanels a[href="#tabListado"]').tab("show")},function(o){i.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})}o.Personas=[],o.Persona={},o.Permisos=[],o.title="Nuevo Registro",o.editMode=!1,o.valUser=!1,o.ValLogin=!1,o.TipoDocumentos=[],o.TipoSelect={},s(),u(),d(),o.$parent.SetTitulo("GESTION DE PERSONAL"),c(),o.permisosByPerfil=function(){if(!o.editMode){o.Persona.Permisos=[];var e=t.getPermisoByPerfil(2);e.then(function(e){e.data.length&&(o.Persona.Permisos=angular.copy(e.data))},function(o){i.pop("error","¡Error!","Error al cargar permisos del perfil seleccionado"),console.log("error al cargar permisos",o)})}},o.Nuevo=function(){c(),o.editMode=!1,o.title="Nuevo Registro",o.active="",d()},o.get=function(e){o.editMode=!0,o.title="Editando Empleado",o.active="active",o.Persona=e,console.log(o.Persona),$('#tabPanels a[href="#tabRegistro"]').tab("show")},o.Guardar=function(){if(!o.Persona.Cedula||""===o.Persona.Cedula)return void i.pop("warning","¡Alerta!","Por favor ingrese la identificación");o.Persona.MovilDos=o.Persona.MovilDos?o.Persona.MovilDos:"",o.Persona.Nombre=o.Persona.Nombre.toUpperCase(),o.Persona.TipoDocumento=o.TipoSelect.tdCodigo;var r;if(o.editMode)r=e.put(o.Persona.IdPersona,o.Persona);else{if(!o.Persona.Login)return void i.pop("info","¡Alerta!","Ingrese el nombre de usuario");if(0===o.Persona.Permisos.length)return void i.pop("info","¡Alerta!","Seleccione al menos un permiso");if(o.ValLogin)return void i.pop("error","¡Alerta!","Nombre de usuario ya existe en el sistema");o.Persona.Login=o.Persona.Login.toUpperCase(),r=e.post(o.Persona)}r.then(function(e){e.data.request>0&&!o.editMode?(o.Persona.PersonaId=e.data.request,l(o.Persona)):(i.pop("success","Control de información",e.data.message),o.Nuevo()),$('#tabPanels a[href="#tabListado"]').tab("show")},function(o){i.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})},o.Desactivar=function(o,r){var t=confirm("¿Está seguro de Ejecutar esta Acción? ("+r+")");if(1==t){var i={Estado:r},n=e.updateEstado(o,i);n.then(function(o){Materialize.toast(o.data.message,4e3,"rounded"),s()},function(o){alert("ERROR AL PROCESAR DESACTIVAR / ACTIVAR"),console.log("Some Error Occured "+JSON.stringify(o))})}},o.validarUser=function(){if(o.Persona.Cedula){o.valUser=!1;var r=e.validarUser(o.Persona.Cedula);r.then(function(e){e.data.idPersona&&(o.valUser=!0,Materialize.toast("Cedula, Ya Existe.. !!",4e3,"rounded"))},function(o){alert("ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})}},o.ValidarLogin=function(){if(o.ValLogin=!1,!o.editMode){if(!o.Persona.Login)return void i.pop("info","¡Alerta!","Por favor ingrese el Login");var e=n.validar(o.Persona.Login);e.then(function(e){e.data.Login&&(o.ValLogin=!0,i.pop("info","Nombre de usuario ya existe"))},function(o){i.pop("error","Error","Error al validar nombre de usuario"),console.log("Some Error Occured "+JSON.stringify(o))})}}}]),app.controller("rutaController",["$scope","rutaService","tipoVehiculoService","departamentoService","toaster","ngTableParams","plantillaService",function(o,e,r,t,i,n,a){function c(){o.Ruta={rtCodigo:"",rtNombre:"",rtDescripcion:"",trTipoVehiculo:"",trValor:"0",trDepartamento:"",trCiudad:"",trEstado:"ACTIVO",trImagen:"",rtPlantilla:"0"},document.getElementById("image").innerHTML="",o.estadoImg=!1}function s(){var r=e.getAll();r.then(function(e){o.Rutas=e.data,o.TablaRuta.reload()},function(o){i.pop("error","¡Error!","Error al cargar Ruta"),console.log("Some Error Occured "+JSON.stringify(o))})}function u(){var e=r.getAll();e.then(function(e){o.TipoVehiculos=e.data,e.data&&(o.VehiculoSelect=e.data[0])},function(o){i.pop("error","¡Error!","Error al cargar Tipo de Vehiculo"),console.log("Some Error Occured "+JSON.stringify(o))})}function d(){var e=a.getAll();e.then(function(e){o.Plantillas=e.data,e.data&&(o.PlantillaSelect=e.data[0])},function(o){i.pop("error","¡Error!","Error al cargar Plantillas"),console.log("Some Error Occured "+JSON.stringify(o))})}function l(){var e=t.getAll();e.then(function(e){o.Departamentos=e.data,e.data&&(o.DeptSelect=e.data[0],p(o.DeptSelect.dtCodigo))},function(o){i.pop("error","¡Error!","Error al cargar Departamentos"),console.log("Some Error Occured "+JSON.stringify(o))})}function p(e){var r=t.getMunicipios(e);r.then(function(e){o.Municipios=e.data,e.data&&(o.MunSelect=e.data[0])},function(o){i.pop("error","¡Error!","Error al cargar Departamentos"),console.log("Some Error Occured "+JSON.stringify(o))})}function g(){o.TablaRuta=new n({page:1,count:10,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Rutas.filter(function(o){return o.rtCodigo.toLowerCase().indexOf(t)>-1||o.rtNombre.toLowerCase().indexOf(t)>-1||o.rtDescripcion.toLowerCase().indexOf(t)>-1||o.trCiudad.toLowerCase().indexOf(t)>-1||o.trEstado.toLowerCase().indexOf(t)>-1})):f=o.Rutas,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}o.Ruta={},o.Rutas=[],o.TipoVehiculos=[],o.Departamentos=[],o.Municipios=[],o.Plantillas=[],o.IdRutapGlobal="",o.editMode=!1,o.estadoImg=!1,o.title="Nueva Ruta",o.VehiculoSelect={},o.PlantillaSelect={},o.DeptSelect={},o.MunSelect={},o.TablaRuta={},o.$parent.SetTitulo("RUTA"),c(),c(),u(),d(),l(),o.CambiaDept=function(){p(o.DeptSelect.dtCodigo)},o.Guardar=function(){o.Ruta.trTipoVehiculo=o.VehiculoSelect.tvCodigo,o.Ruta.trCiudad=o.MunSelect.muCodigo,o.Ruta.rtPlantilla=o.PlantillaSelect.plCodigo,o.Ruta.trDepartamento=o.DeptSelect.dtCodigo,o.Ruta.rtNombre=o.Ruta.rtNombre.toUpperCase(),o.Ruta.rtDescripcion=o.Ruta.rtDescripcion.toUpperCase();var r=new FormData;r.append("imagen",o.Ruta.trImagen);var t;t=o.editMode?e.put(o.Ruta.rtCodigo,o.Ruta):e.post(o.Ruta),t.then(function(o){s(),i.pop("success","Control de Información",o.data.message),c()},function(o){i.pop("error","¡Error!","Error al guardar Ruta"),console.log("Some Error Occured "+JSON.stringify(o))})},o.nuevo=function(){c(),o.editMode=!1,o.title="Nueva Ruta"},o.get=function(e){o.Ruta=e,o.editMode=!0,o.title="Editar Ruta",o.active="active",$('#tabPanels a[href="#tabRegistroRuta"]').tab("show")},o.VerDesactivar=function(e,r){o.trEstado=r,o.IdRutapGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var r={trEstado:o.trEstado};$("#mdConfirmacion").modal("hide");var t=e.updateEstado(o.IdRutapGlobal,r);t.then(function(o){i.pop("success","Control de Información",o.data.message),s()},function(o){i.pop("error","Error","Error al Desactivar Ruta"),console.log("Some Error Occured "+JSON.stringify(o))})},g(),o.modificarImagen=function(){var r=new FormData;if(r.append("imagen",o.Ruta.trImagen),r.append("id",o.Ruta.rtCodigo),!o.Ruta.trImagen)return void(o.estadoImg=!0);var t=e.postImagen(r);t.then(function(o){i.pop("success","Imagen","Imágen cambiada corretamente"),$('#tabPanels a[href="#tabListado"]').tab("show")},function(o){i.pop("error","Error!","Error al cambiar Imagen"),console.log(JSON.stringify(o))})},s()}]),app.controller("serviciosController",["$scope","zonaService","ngTableParams","toaster",function(o,e,r,t){function i(){this.coordenadas=null,this.marcador=null}function n(){o.Servicio={Origen:"",Destino:""}}function a(){var e=document.getElementById("txtOrigen");o.AutocompleteOrigen=new google.maps.places.Autocomplete(e,h),o.AutocompleteOrigen.bindTo("bounds",o.mapServicio),o.AutocompleteOrigen.addListener("place_changed",function(){C.close(),o.markerOrigen.setVisible(!1);var e=o.AutocompleteOrigen.getPlace();if(!e.geometry)return void t.pop("error","¡Error!","No pudo resolver la  posición");p(o.mapServicio,e),o.markerOrigen.setIcon("images/origen.png"),o.markerOrigen.setPosition(e.geometry.location),o.markerOrigen.setVisible(!0),o.popup||(o.popup=new google.maps.InfoWindow);var r="";e.address_components&&(r=[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")),C.setContent("<div><strong>"+e.name+"</strong><br>"+r),C.open(o.mapServicio,o.markerOrigen),S=e.place_id,l(S,O,I,N,T)})}function c(){var e=document.getElementById("txtDestino");o.AutocompleteDestino=new google.maps.places.Autocomplete(e,h),o.AutocompleteDestino.bindTo("bounds",o.mapServicio),o.AutocompleteDestino.addListener("place_changed",function(){C.close(),E.setVisible(!1);var e=o.AutocompleteDestino.getPlace();if(!e.geometry)return void t.pop("error","¡Error!","No pudo resolver la  posición");p(o.mapServicio,e),E.setIcon("images/destino.png"),E.setPosition(e.geometry.location),E.setVisible(!0),o.popup||(o.popup=new google.maps.InfoWindow);var r="";e.address_components&&(r=[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")),C.setContent("<div><strong>"+e.name+"</strong><br>"+r),C.open(o.mapServicio,E),O=e.place_id,l(S,O,I,N,T)})}function s(){var r=e.getAll();r.then(function(e){o.Zonas=e.data,o.tbZona.reload()},function(o){t.pop("error","¡Error!","Eror al cargar zonas"),console.log("failure loading Zona",o)})}function u(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var r={lat:e.coords.latitude,lng:e.coords.longitude};o.Posicion.Latitud=e.coords.latitude,o.Posicion.Longitud=e.coords.longitude;var t=new google.maps.Circle({center:r,radius:e.coords.accuracy});o.AutocompleteOrigen.setBounds(t.getBounds())})}function d(){var e={zoom:16,center:new google.maps.LatLng(o.Posicion.Latitud,o.Posicion.Longitud),mapTypeId:google.maps.MapTypeId.ROADMAP};o.mapServicio=new google.maps.Map(document.getElementById("dvMapaServicio"),e),T.setMap(o.mapServicio),google.maps.event.addListener(o.mapServicio,"click",function(e){var r=e.latLng.lat(),t=e.latLng.lng(),n=new google.maps.LatLng(r,t),a=new google.maps.Marker({position:n,map:o.mapServicio,animation:google.maps.Animation.DROP,title:"Marcador"}),c=new i;c.coordenadas=n,c.marcador=a,o.vecPoligono.push(c),v()}),o.markerOrigen=new google.maps.Marker({map:o.mapServicio}),E=new google.maps.Marker({map:o.mapServicio})}function l(o,e,r,i,n){o&&e&&i.route({origin:{placeId:o},destination:{placeId:e},travelMode:r},function(o,e){e===google.maps.DirectionsStatus.OK?n.setDirections(o):t.pop("error","¡Error!","Error al resolver dirección")})}function p(o,e){e.geometry.viewport?o.fitBounds(e.geometry.viewport):(o.setCenter(e.geometry.location),o.setZoom(17))}function g(){o.tbZona=new r({page:1,count:5,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().filtroT;f=[],t?(t=t.toLowerCase(),f=o.Zonas.filter(function(o){return o.placa.toLowerCase().indexOf(t)>-1||o.identificacion.toLowerCase().indexOf(t)>-1||o.Nombre.toLowerCase().indexOf(t)>-1||o.Apellidos.toLowerCase().indexOf(t)>-1})):f=o.Zonas,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}function v(){for(var e=[],r=0;r<o.vecPoligono.length;r++)e.push(o.vecPoligono[r].coordenadas);null!==o.poly&&o.poly.setMap(null),o.poly=new google.maps.Polygon({paths:e,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25}),o.poly.setMap(o.mapServicio)}function m(r){var n=e.getPuntos(r);n.then(function(e){if(o.Puntos=e.data,o.Puntos){var r=new google.maps.LatLngBounds,t=0;$.each(o.Puntos,function(e,n){t+=1;var a=new google.maps.LatLng(n.ptLatitud,n.ptLongitud),c=new google.maps.Marker({position:a,map:o.mapServicio,animation:google.maps.Animation.DROP,title:"Punto # "+t});r.extend(c.position);var s=new i;s.coordenadas=a,s.marcador=c,o.vecPoligono.push(s)}),v(),o.mapServicio.fitBounds(r)}},function(o){t.pop("error","¡Error!",o.data.request),console.log("failure loading Zona",o)})}o.Zonas=[],o.Zona={},o.funcion=null,o.Servicio={},o.Puntos=[],o.editMode=!1,o.mapServicio,o.markerOrigen=null;var E=null,C=new google.maps.InfoWindow,h={componentRestrictions:{country:"co"}},S=null,O=null,I=google.maps.TravelMode.DRIVING,N=new google.maps.DirectionsService,T=new google.maps.DirectionsRenderer;o.vecPoligono=new Array,o.poly=null,o.tbZona={},o.title="Nuevo Servicio",o.Posicion={Latitud:10.4370725,Longitud:-75.524795},o.$parent.SetTitulo("GESTIÓN DE SERVICIOS"),o.AutocompleteOrigen=null,o.AutocompleteDestino=null,u(),d(),a(),c(),g(),n(),o.eliminarUltimoPunto=function(){o.vecPoligono.length>0&&(o.vecPoligono[o.vecPoligono.length-1].marcador.setMap(null),o.vecPoligono.pop(),v())},o.nuevo=function(){o.editMode=!1,o.title="NUEVA ZONA"},o.get=function(e){o.editMode=!0,o.title="EDITAR ZONA",o.Zona=e,m(e.znCodigo)},o.guardar=function(){if(o.vecPoligono.length<3)return void t.pop("info","¡Alerta!","Es necesario por lo menos 3 puntos en la región.. Verifique !!");for(var r="",i=[],n="",a=0;a<o.vecPoligono.length;a++){0===a&&(r+=o.vecPoligono[a].coordenadas.lat()+" ",r+=o.vecPoligono[a].coordenadas.lng()),n+=o.vecPoligono[a].coordenadas.lat()+" ",n+=o.vecPoligono[a].coordenadas.lng()+", ";var c={lt:o.vecPoligono[a].coordenadas.lat(),lg:o.vecPoligono[a].coordenadas.lng()};i.push(c)}n+=r;var u,c={znNombre:o.Zona.znNombre.toUpperCase(),znArea:n,znEstado:o.Zona.znEstado,puntos:i};u=o.editMode?e.put(o.Zona.znCodigo,c):e.post(c),u.then(function(e){t.pop("success","¡Información!",e.data.message),o.nuevo(),s()},function(o){t.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})},o.VerEliminar=function(e){o.znCodigo=e,$("#mdConfirmacion").modal("show")},o.eliminar=function(){var r={znCodigo:o.znCodigo};$("#mdConfirmacion").modal("hide");var i=e.delete(o.znCodigo,r);i.then(function(o){t.pop("success","Control de Información",o.data.message),s()},function(o){t.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})}}]),app.controller("tipoDocumentoController",["$scope","tipoDocumentoService","toaster",function(o,e,r){function t(){o.TipoDocumento={tdCodigo:"",tdDescripcion:"",tdEstado:"ACTIVO"}}function i(){var t=e.getAll();t.then(function(e){o.TipoDocumentos=e.data},function(o){r.pop("error","¡Error!","Error al cargar Tipo Documento"),console.log("Some Error Occured "+JSON.stringify(o))})}o.TipoDocumento={},o.TipoDocumentos=[],o.IdTipoGlobal="",o.editMode=!1,o.title="NUEVO TIPO DOCUMENTO",o.$parent.SetTitulo("TIPO DOCUMENTO"),t(),o.Guardar=function(){o.TipoDocumento.tdCodigo=o.TipoDocumento.tdCodigo.toUpperCase(),o.TipoDocumento.tdDescripcion=o.TipoDocumento.tdDescripcion.toUpperCase(),o.TipoDocumento.tdEstado=o.TipoDocumento.tdEstado.toUpperCase();var n;n=o.editMode?e.put(o.TipoDocumento.tdCodigo,o.TipoDocumento):e.post(o.TipoDocumento),n.then(function(o){i(),r.pop("success","Control de Información",o.data.message)},function(o){r.pop("error","Error","Error al guardar Tipo Documento"),console.log("Some Error Occured "+JSON.stringify(o))}),t()},o.nuevo=function(){t(),o.editMode=!1,o.title="NUEVO TIPO DOCUMENTO"},o.get=function(e){o.TipoDocumento=e,o.editMode=!0,o.title="EDITAR TIPO DOCUMENTO",o.active="active"},o.VerDesactivar=function(e,r){o.tdEstado=r,o.IdTipoGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={tdEstado:o.tdEstado};$("#mdConfirmacion").modal("hide");var n=e.updateEstado(o.IdTipoGlobal,t);n.then(function(o){r.pop("success","Control de Información",o.data.message),i()},function(o){r.pop("error","Error","Error  al desactivar Tipo Documento"),console.log("Some Error Occured "+JSON.stringify(o))})},i()}]),app.controller("tipoMantenimientoController",["$scope","tipoMantenimientoService","toaster",function(o,e,r){function t(){o.TipoMantenimiento={tmDescripcion:"",tmEstado:"ACTIVO",tmCodigo:0}}function i(){var t=e.getAll();t.then(function(e){o.TipoMantenimientos=e.data},function(o){r.pop("error","¡Error!","Error al cargar Tipo de Mantenimiento"),console.log("Some Error Occured "+JSON.stringify(o))})}o.TipoMantenimiento={},o.TipoMantenimientos=[],o.IdTipoGlobal="",o.editMode=!1,o.title="Nuevo Tipo de Mantenimiento",o.$parent.SetTitulo("TIPO DE MANTENIMIENTO"),t(),o.Guardar=function(){o.TipoMantenimiento.tmDescripcion=o.TipoMantenimiento.tmDescripcion.toUpperCase();var n;n=o.editMode?e.put(o.TipoMantenimiento.tmCodigo,o.TipoMantenimiento):e.post(o.TipoMantenimiento),n.then(function(o){i(),r.pop("success","Control de Información",o.data.message),t()},function(o){r.pop("error","¡Error!","Error al guardar tipo de Vehículo"),console.log("Some Error Occured "+JSON.stringify(o))})},o.nuevo=function(){t(),o.editMode=!1,o.title="Nuevo Tipoo de Mantenimiento"},o.get=function(e){o.TipoMantenimiento=e,o.editMode=!0,o.title="Editar Tipo de Mantenimiento",o.active="active"},o.VerDesactivar=function(e,r){o.tmEstado=r,o.IdTipoGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={tmEstado:o.tmEstado};$("#mdConfirmacion").modal("hide");var n=e.updateEstado(o.IdTipoGlobal,t);n.then(function(o){r.pop("success","Control de Información",o.data.message),i()},function(o){r.pop("error","Error","Error al Desactivar tipo de Mantenimiento"),console.log("Some Error Occured "+JSON.stringify(o))})},i()}]),app.controller("servicioController",["$scope","tiposervicioService","toaster","tipoVehiculoService",function(o,e,r,t){function i(){o.Servicio={svDescripcion:"",svEstado:"ACTIVO",svCodigo:0,TipoVehiculo:[]}}function n(){var t=e.getAll();t.then(function(e){o.Servicios=e.data},function(o){r.pop("error","¡Error!","Error al cargar Servicios"),console.log("Some Error Occured "+JSON.stringify(o))})}function a(){var e=t.getAll();e.then(function(e){o.TipoVehiculos=e.data},function(o){r.pop("error","¡Error!","Error al cargar Tipo de Vehiculo"),console.log("Some Error Occured "+JSON.stringify(o))})}o.Servicio={},o.Servicios=[],o.IdServicioGlobal="",o.editMode=!1,o.title="NUEVO SERVICIO",o.TipoVehiculos=[],o.$parent.SetTitulo("GESTION DE SERVICIOS"),i(),a(),o.Guardar=function(){if(0==o.Servicio.TipoVehiculo.length)return void r.pop("error","¡Error!","Seleccione el tipo de vehículo");o.Servicio.svDescripcion=o.Servicio.svDescripcion.toUpperCase();var t;t=o.editMode?e.put(o.Servicio.svCodigo,o.Servicio):e.post(o.Servicio),t.then(function(o){n(),r.pop("success","Control de Información",o.data.message)},function(o){r.pop("error","¡Error!",o.data.message),console.log("Some Error Occured "+JSON.stringify(o))}),i()},o.Nuevo=function(){o.editMode=!1,o.title="NUEVO SERVICIO",i()},o.get=function(e){o.Servicio=e,o.editMode=!0,o.title="EDITAR SERVICIO";var r=[];e.TipoVehiculo&&(r=JSON.parse("["+e.TipoVehiculo+"]")),o.Servicio.TipoVehiculo=angular.copy(r)},o.VerDesactivar=function(e,r){o.svEstado=r,o.IdServicioGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={svEstado:o.svEstado};$("#mdConfirmacion").modal("hide");var i=e.updateEstado(o.IdServicioGlobal,t);i.then(function(o){r.pop("success","Control de Información",o.data.message),n()},function(o){r.pop("error","Error","ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})},n()}]),app.controller("tipoVehiculoController",["$scope","tipoVehiculoService","toaster",function(o,e,r){function t(){o.TipoVehiculo={tvDescripcion:"",tvEstado:"ACTIVO",tvNumPasajero:0,tvCodigo:0}}function i(){var t=e.getAll();t.then(function(e){o.TipoVehiculos=e.data},function(o){r.pop("error","¡Error!","Error al cargar Tipo de Vehiculo"),console.log("Some Error Occured "+JSON.stringify(o))})}o.TipoVehiculo={},o.TipoVehiculos=[],o.IdTipoGlobal="",o.editMode=!1,o.title="NUEVO TIPO VEHICULO",o.$parent.SetTitulo("TIPOS DE VEHICULO"),t(),o.Guardar=function(){o.TipoVehiculo.tvDescripcion=o.TipoVehiculo.tvDescripcion.toUpperCase();var n;n=o.editMode?e.put(o.TipoVehiculo.tvCodigo,o.TipoVehiculo):e.post(o.TipoVehiculo),n.then(function(o){i(),r.pop("success","Control de Información",o.data.message),t()},function(o){r.pop("error","¡Error!","Error al guardar tipo de Vehículo"),console.log("Some Error Occured "+JSON.stringify(o))})},o.nuevo=function(){t(),o.editMode=!1,o.title="NUEVO TIPO VEHICULO"},o.get=function(e){o.TipoVehiculo=e,o.editMode=!0,o.title="EDITAR TIPO VEHICULO",o.active="active"},o.VerDesactivar=function(e,r){o.tvEstado=r,o.IdTipoGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={tvEstado:o.tvEstado};$("#mdConfirmacion").modal("hide");var n=e.updateEstado(o.IdTipoGlobal,t);n.then(function(o){r.pop("success","Control de Información",o.data.message),i()},function(o){r.pop("error","Error","Error al Desactivar tipo de Vehiculo"),console.log("Some Error Occured "+JSON.stringify(o))})},i()}]),app.controller("transfertController",["$scope","zonaService","ngTableParams","toaster","transfertService","tipoVehiculoService",function(o,e,r,t,i,n){function a(){var r=e.getAll();r.then(function(e){o.Zonas=e.data,e.data&&(o.ZonaOrigen=e.data[0],o.ZonaDestino=e.data[1])},function(o){t.pop("error","¡Error!","Eror al cargar zonas"),console.log("failure loading Zona",o)})}function c(){var e=n.getAll();e.then(function(e){o.ClaseVehiculo=e.data,e.data&&(o.ClaseSelect=e.data[0])},function(o){t.pop("error","¡Error!","Eror al cargar tipos de vehículo"),console.log("Some Error Occured "+JSON.stringify(o))})}function s(){var e=i.getAll();e.then(function(e){o.Transferts=e.data,o.tbTransfert.reload()},function(o){t.pop("error","¡Error!","Eror al cargar tarifas"),console.log("failure loading Zona",o)})}function u(){o.Transfert={tfCodigo:0,tfNombre:"",tfOrigen:"",tfDestino:"",tfTipoVehiculo:"",tfValor:0,tfEstado:"ACTIVO",tfUserReg:"",tfUserMod:""}}function d(){o.tbTransfert=new r({page:1,count:15,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Transferts.filter(function(o){return o.tfNombre.toLowerCase().indexOf(t)>-1||o.tvDescripcion.toLowerCase().indexOf(t)>-1})):f=o.Transferts,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}o.Zonas=[],o.Transferts=[],o.Transfert={},o.ClaseVehiculo=[],o.editMode=!1,o.title="NUEVA TARIFA TRANSFERT",o.tbTransfert={},o.ZonaOrigen={},o.ZonaDestino={},o.ClaseSelect={},o.$parent.SetTitulo("GESTIÓN DE TARIFAS TRANSFERT"),a(),c(),s(),u(),d(),o.Nuevo=function(){u(),o.editMode=!1,o.title="NUEVA TARIFA TRANSFERT"},o.get=function(e){o.editMode=!0,o.title="EDITANDO  TARIFA TRANSFERT",o.Transfert=e},o.Guardar=function(){if(!o.ZonaOrigen)return void t.pop("info","¡Alerta!","Seleccione la zona origen");if(!o.ZonaDestino)return void t.pop("info","¡Alerta!","Seleccione la zona  destino");if(o.ZonaOrigen.znCodigo===o.ZonaDestino.znCodigo)return void t.pop("info","¡Alerta!","Zona destino debe ser diferente a zona origen");if(!o.ClaseSelect)return void t.pop("info","¡Alerta!","Seleccione el tipo de vehículo");o.Transfert.tfOrigen=o.ZonaOrigen.znCodigo,o.Transfert.tfDestino=o.ZonaDestino.znCodigo,o.Transfert.tfTipoVehiculo=o.ClaseSelect.tvCodigo,o.Transfert.tfUserReg=o.$parent.Login.Login;var e;o.editMode?(e=i.put(o.Transfert.tfCodigo,o.Transfert),o.Transfert.tfUserMod=o.$parent.Login.Login):e=i.post(o.Transfert),e.then(function(e){t.pop("success","¡Información!",e.data.message),o.Nuevo(),s()},function(o){t.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})},o.VerDesactivar=function(e,r){o.Estado=r,o.IdTranferGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var e={estado:o.Estado};$("#mdConfirmacion").modal("hide");var r=i.updateEstado(o.IdTranferGlobal,e);r.then(function(o){t.pop("success","Control de Información",o.data.message),s()},function(o){t.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})}}]),app.controller("usuarioController",["$scope","usuarioService","toaster","ngTableParams","perfilService","personaService","funcionService","clienteService","conductorService",function(o,e,r,t,i,n,a,c,s){function u(){o.Usuario={IdUsuario:"",Login:"",Nombre:"",Estado:"ACTIVO",Modulo:"",Sesion:"CERRADA",DirIp:"",ClienteId:null,PersonaId:null,ConductorId:null,TipoAcceso:"",ValidarClave:"SI",Email:"",Contrato:"",Permisos:[],Identificacion:""}}function d(){var t=e.getAll();t.then(function(e){o.Usuarios=e.data,o.TablaUsuario.reload()},function(o){r.pop("error","¡Error!","Error al cargar usuarios"),console.log("failure loading usuarios",o)})}function l(){var e=i.getActivos();e.then(function(e){o.Perfiles=e.data,e.data&&(o.PerfilSelect.IdRol=2,o.permisosByPerfil())},function(o){r.pop("error","¡Error!","Error al cargar permisos"),console.log("failure loading Paises",o)})}function p(){var e=i.getPermisos();e.then(function(e){o.Permisos=e.data},function(o){r.pop("error","¡Error!","Error al cargar permisos"),console.log("failure loading Paises",o)})}function g(t){o.Usuario.Permisos=[];var i=e.getPermisos(t);i.then(function(e){e.data.length&&(o.Usuario.Permisos=angular.copy(e.data))},function(o){r.pop("error","¡Error!","Error al cargar permisos del usuario seleccionado"),console.log("error al cargar permisos",o)})}function v(e,t){var i;i=null!==e?n.get(e):n.validar(t),i.then(function(e){e.data?(o.Usuario.Identificacion=e.data.Cedula,o.Usuario.PersonaId=e.data.IdPersona,o.editMode||(o.Usuario.Nombre=e.data.Nombre,o.Usuario.Email=e.data.Correo),o.ExisteIdentificion=!0):r.pop("error","¡Error!","Empleado no se encuentra registrado en el sistema.")},function(o){r.pop("error","¡Error!","Error al cargar permisos del usuario seleccionado"),console.log("error al cargar permisos",o)})}function m(e,t){var i;i=null!==e?c.get(e):c.validarIdentificacion(t),i.then(function(e){e.data?(o.Usuario.Identificacion=e.data.Identificacion,o.Usuario.ClienteId=e.data.IdCliente,o.editMode||(o.Usuario.Nombre=e.data.Nombres,o.Usuario.Email=e.data.Correo),o.ExisteIdentificion=!0):r.pop("error","¡Error!","Empleado no se encuentra registrado en el sistema.")},function(o){r.pop("error","¡Error!","Error al cargar permisos del usuario seleccionado"),console.log("error al cargar permisos",o)})}function E(e,t){var i;i=null!==e?s.get(e):s.validarIdentificacion(t),i.then(function(e){e.data?(o.Usuario.Identificacion=e.data.Cedula,o.Usuario.ConductorId=e.data.IdConductor,o.editMode||(o.Usuario.Nombre=e.data.Nombre,o.Usuario.Email=e.data.Email),o.ExisteIdentificion=!0):r.pop("error","¡Error!","Empleado no se encuentra registrado en el sistema.")},function(o){r.pop("error","¡Error!","Error al cargar permisos del usuario seleccionado"),console.log("error al cargar permisos",o);
})}function C(){o.TablaUsuario=new t({page:1,count:10,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Usuarios.filter(function(o){return o.IdUsuario.toLowerCase().indexOf(t)>-1||o.Nombre.toLowerCase().indexOf(t)>-1||o.Estado.toLowerCase().indexOf(t)>-1})):f=o.Usuarios,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}o.Usuario={},o.Usuarios=[],o.Perfiles=[],o.Permisos=[],o.title="Nuevo Usuario",o.editMode=!1,o.valPass=!1,o.ValLogin=!1,o.IdUsuarioGlobal="",o.ExisteIdentificion=!1,o.TablaUsuario={},o.User={},o.PerfilSelect={},o.$parent.SetTitulo("GESTION DE USUARIOS"),d(),u(),C(),l(),p(),o.Nuevo=function(){u(),l(),o.editMode=!1,o.title="Nuevo Usuario"},o.get=function(e){o.editMode=!0,o.title="Editar Usuario",o.Usuario=e,o.PerfilSelect.IdRol=e.TipoAcceso,o.Usuario.PersonaId?v(o.Usuario.PersonaId,null):o.Usuario.ConductorId?E(o.Usuario.continue,null):o.Usuario.ClienteId&&m(o.Usuario.ClienteId,null),g(e.IdUsuario),$('#tabPanels a[href="#tabRegistro"]').tab("show")},o.permisosByPerfil=function(){if(!o.editMode){o.Usuario.Permisos=[];var e=i.getPermisoByPerfil(o.PerfilSelect.IdRol);e.then(function(e){e.data.length&&(o.Usuario.Permisos=angular.copy(e.data))},function(o){r.pop("error","¡Error!","Error al cargar permisos del perfil seleccionado"),console.log("error al cargar permisos",o)})}},o.Guardar=function(){if(o.ValLogin)return void r.pop("error","¡Error!","Nombre de usuario ya existe");if(!o.ExisteIdentificion)return void r.pop("error","¡Error!","N° Identificación no existe en el sistema");if(0===o.Usuario.Permisos.length)return void r.pop("info","¡Alerta!","Seleccione al menos un permiso");o.Usuario.Modulo=a.GetModuloUser(o.Usuario.Permisos),o.Usuario.Nombre=o.Usuario.Nombre.toUpperCase(),o.Usuario.TipoAcceso=o.PerfilSelect.IdRol;var t;t=o.editMode?e.put(o.Usuario.IdUsuario,o.Usuario):e.post(o.Usuario),t.then(function(e){r.pop("success","Control de Información",e.data.message),o.Nuevo(),d(),$('#tabPanels a[href="#tabListado"]').tab("show")},function(o){r.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})},o.BuscarIdentificacion=function(){return o.Usuario.Identificacion?void(3===o.PerfilSelect.IdRol?E(null,o.Usuario.Identificacion):1===o.PerfilSelect.IdRol||2===o.PerfilSelect.IdRol?v(null,o.Usuario.Identificacion):4!==o.PerfilSelect.IdRol&&4!==o.PerfilSelect.IdRol||m(null,o.Usuario.Identificacion)):void r.pop("info","¡Alerta!","Por favor ingrese el número de identificación")},o.ValidarLogin=function(){if(o.ValLogin=!1,!o.editMode){if(!o.Usuario.Login)return void r.pop("info","¡Alerta!","Por favor ingrese el Login");var t=e.validar(o.Usuario.Login);t.then(function(e){e.data.Login&&(o.ValLogin=!0,r.pop("info","Nombre de usuario ya existe"))},function(o){r.pop("error","Error","Error al validar login"),console.log("Some Error Occured "+JSON.stringify(o))})}},o.CambiarPass=function(e,r){o.User={IdUsuario:e,Nombre:r,Clave:"",claveConf:""},$('#tabPanels a[href="#tabCambiarC"]').tab("show")},o.cancelar=function(){o.valPass=!1,o.User={IdUsuario:"",Nombre:"",Clave:"",claveConf:""},$('#tabPanels a[href="#tabListado"]').tab("show")},o.guardarPass=function(){if(o.valPass=!1,o.User.Clave!=o.User.claveConf)return void(o.valPass=!0);var t={Clave:o.User.Clave},i=e.udpatePass(o.User.IdUsuario,t);i.then(function(e){o.cancelar()},function(o){r.pop("error","Error","ERROR AL CAMBIAR CONTRASEÑA"),console.log("Some Error Occured "+JSON.stringify(o))})},o.VerDesactivar=function(e,r){o.Estado=r,o.IdUsuarioGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var t={Estado:o.Estado};$("#mdConfirmacion").modal("hide");var i=e.updateEstado(o.IdUsuarioGlobal,t);i.then(function(o){r.pop("success","Control de Información",o.data.message),d()},function(o){r.pop("error","Error","ERROR AL PROCESAR DESACTIVAR / ACTIVAR"),console.log("Some Error Occured "+JSON.stringify(o))})},C()}]),app.controller("perfilController",["$scope","perfilService","toaster",function(o,e,r){function t(){o.Perfil={IdRol:0,Descripcion:"",rEstado:"",Permisos:[]}}function i(){var t=e.getAll();t.then(function(e){o.Perfiles=e.data},function(o){r.pop("error","¡Error!","Error al cargar permisos"),console.log("failure loading Paises",o)})}function n(){var t=e.getPermisos();t.then(function(e){o.Permisos=e.data},function(o){r.pop("error","¡Error!","Error al cargar permisos"),console.log("failure loading Paises",o)})}o.Perfiles=[],o.Perfil={},o.Permisos=[],o.editMode=!1,o.title="",i(),n(),t(),o.get=function(e){t(),o.Perfil=e,o.editMode=!0,o.title="EDITANDO PERFIL",o.permisosByPerfil(e.IdRol)},o.Nuevo=function(){o.editMode=!1,o.title="",t()},o.permisosByPerfil=function(t){o.Perfil.Permisos=[];var i=e.getPermisoByPerfil(t);i.then(function(e){if(e.data.length){var r=JSON.parse("["+e.data[0].permisos+"]");o.Perfil.Permisos=angular.copy(r)}},function(o){r.pop("error","¡Error!","Error al cargar permisos del perfil seleccionado"),console.log("error al cargar permisos",o)})},o.Guardar=function(){if(""===o.Perfil.Descripcion)return void r.pop("info","¡Alerta!","Ingrese Descripción del perfil");if(0===o.Perfil.Permisos.length)return void r.pop("info","¡Alerta!","Seleccione al menos un permiso");var a;a=o.editMode?e.put(o.Perfil.IdRol,o.Perfil):e.post(o.Perfil),a.then(function(o){i(),n(),r.pop("success","Control de Información",o.data.message),t()},function(o){r.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})},o.VerInactivo=function(e){o.IdPerfil=e,$("#mdPerfil").modal("show")},o.Inactivar=function(){$("#mdPerfil").modal("hide");var t=e.delete(o.IdPerfil);t.then(function(o){r.pop("success","¡Información!",o.data.message),i()},function(o){r.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})}}]),app.controller("vehiculoController",["$scope","vehiculoService","marcaService","tipoVehiculoService","ngTableParams","toaster","novedadService",function(o,e,r,t,i,n,a){function c(){o.Vehiculo={Placa:"",IdVehiculo:0,Color:"",Cilindraje:"",Movil:"",Estado:"ACTIVO",Tipo:"PROPIO",FechaArriendo:moment().format("L"),NumPasajeros:4,ClaseVehiculo:1,Runt:"",FProxMantenimiento:moment().format("L"),Marca:""}}function s(){o.Novedad={IdNovedad:0,Codigo:"",FechaExpedicion:moment().format("L"),FechaInicioVigencia:moment().format("L"),FechaVencimiento:moment().add(1,"years").format("L"),Entidad:"",Estado:"VIGENTE",ModServicio:"",RadioAccion:"",Vehiculo:"",Tipo:"SOAT"},o.editMode=!1}function u(){var r=e.getAll();r.then(function(e){o.Vehiculos=e.data,o.TablaVehiculo.reload()},function(o){n.pop("error","¡Error!","Error al cargar Vehiculos"),console.log("Some Error Occured "+JSON.stringify(o))})}function d(){var e=r.getAll();e.then(function(e){o.Marcas=e.data,o.Marcas&&(o.MarcaSelect=e.data[0])},function(o){n.pop("error","¡Error!","Error al cargar Marcas"),console.log("Some Error Occured "+JSON.stringify(o))})}function l(){var e=t.getAll();e.then(function(e){o.ClaseVehiculo=e.data,e.data&&(o.ClaseSelect=e.data[0])},function(o){alert("ERROR AL PROCESAR SOLICITUD"),console.log("Some Error Occured "+JSON.stringify(o))})}function p(){o.TablaVehiculo=new i({page:1,count:20,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Vehiculos.filter(function(o){return o.Placa.toLowerCase().indexOf(t)>-1||o.Movil.toLowerCase().indexOf(t)>-1||o.Tipo.toLowerCase().indexOf(t)>-1||o.Estado.toLowerCase().indexOf(t)>-1})):f=o.Vehiculos,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}function g(r){var t=e.getNovedad(r);t.then(function(e){o.Novedades=e.data,o.TablaNovedad.reload()},function(o){n.pop("error","Error","No se pudo procesar la solicitud"),console.log("Some Error Occured "+JSON.stringify(o))})}function v(){o.TablaNovedad=new i({page:1,count:10,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().busqueda;f=[],t?(t=t.toLowerCase(),f=o.Taxis.filter(function(o){return o.Codigo.toLowerCase().indexOf(t)>-1||o.Estado.toLowerCase().indexOf(t)>-1||o.Tipo.toLowerCase().indexOf(t)>-1||o.FechaVencimiento.indexOf(t)>-1})):f=o.Novedades,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}o.Vehiculo={},o.Vehiculos=[],o.Marcas=[],o.editMode=!1,o.valPlaca=!1,o.ClaseVehiculo=[],o.TablaVehiculo={},o.Titulo="Nuevo",o.Novedades=[],o.Novedad={},o.TablaNovedad={},o.PlacaGlobal="",o.IdVehiculoGlobal="",o.MarcaSelect={},o.ClaseSelect={},u(),d(),l(),p(),o.get=function(e){o.Vehiculo=e,o.Vehiculo.FechaArriendo=moment(o.Vehiculo.FechaArriendo).format("L"),o.Vehiculo.FProxMantenimiento=moment(o.Vehiculo.FProxMantenimiento).format("L"),o.editMode=!0,o.Titulo="Editando ",$('#tabPanels a[href="#tabRegistro"]').tab("show")},o.Nuevo=function(){c(),o.editMode=!1,o.Titulo="Nuevo "},o.VerNovedad=function(e){o.Vehiculo=e,g(e.IdVehiculo),s(),$('#tabPanels a[href="#tabNovedad"]').tab("show")},o.Guardar=function(){if(o.Vehiculo.Marca=o.MarcaSelect.maCodigo,o.Vehiculo.Placa=o.Vehiculo.Placa.toUpperCase(),o.valPlaca)return void n.pop("error","¡Error!","Placa ya se encuentra registrada.");console.log(o.Vehiculo);var r;r=o.editMode?e.put(o.Vehiculo.IdVehiculo,o.Vehiculo):e.post(o.Vehiculo),r.then(function(o){u(),n.pop("success","Control de Información",o.data.message)},function(o){n.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})},c(),v(),o.AgregarNovedad=function(){if(!o.Vehiculo.IdVehiculo)return void n.pop("warning","Validación","No existe un veículo seleccionado");o.Novedad.Entidad=o.Novedad.Entidad.toUpperCase(),o.Novedad.Vehiculo=o.Vehiculo.IdVehiculo;var e;e=o.editMode?a.put(o.Novedad.IdNovedad,o.Novedad):a.post(o.Novedad),e.then(function(e){g(o.Vehiculo.IdVehiculo),n.pop("success","Control de Información",e.data.message),s()},function(o){n.pop("error","Error","Error al procesar solicitud"),console.log("Some Error Occured "+JSON.stringify(o))})},o.CambiarFormato=function(e){o.Vehiculo[e]=moment(o.Vehiculo[e]).format("L")},o.ValidarPlaca=function(){if(o.valPlaca=!1,o.Vehiculo.Placa&&!o.editMode){var r=e.validarPlaca(o.Vehiculo.Placa);r.then(function(e){e.data.Placa&&(o.valPlaca=!0,n.pop("info","¡Alerta!","Placa ya se encuentra registrada."))},function(o){n.pop("error","¡Error!","Error al validar placa."),console.log("Some Error Occured "+JSON.stringify(o))})}},o.VerDesactivar=function(e,r){o.Estado=r,o.IdVehiculoGlobal=e,$("#mdConfirmacion").modal("show")},o.Desactivar=function(){var r={estado:o.Estado};$("#mdConfirmacion").modal("hide");var t=e.updateEstado(o.IdVehiculoGlobal,r);t.then(function(o){n.pop("success","Control de Información",o.data.message),u()},function(o){n.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})}}]),app.controller("zonaController",["$scope","zonaService","ngTableParams","toaster",function(o,e,r,t){function i(){this.coordenadas=null,this.marcador=null}function n(){o.funcion={init:function(){o.Zona={znCodigo:"",znNombre:"",znEstado:"ACTIVO"},d()}}}function a(){var r=e.getAll();r.then(function(e){o.Zonas=e.data,o.tbZona.reload()},function(o){t.pop("error","¡Error!","Eror al cargar zonas"),console.log("failure loading Zona",o)})}function c(){o.tbZona=new r({page:1,count:5,sorting:void 0},{filterDelay:50,total:1e3,counts:[],getData:function(e,r){var t=r.filter().filtroT;f=[],t?(t=t.toLowerCase(),f=o.Zonas.filter(function(o){return o.placa.toLowerCase().indexOf(t)>-1||o.identificacion.toLowerCase().indexOf(t)>-1||o.Nombre.toLowerCase().indexOf(t)>-1||o.Apellidos.toLowerCase().indexOf(t)>-1})):f=o.Zonas,f=r.sorting()?f:f,r.total(f.length),e.resolve(f.slice((r.page()-1)*r.count(),r.page()*r.count()))}})}function s(){var e={zoom:16,center:new google.maps.LatLng(10.4370725,(-75.524795)),mapTypeId:google.maps.MapTypeId.ROADMAP};o.mapZona=new google.maps.Map(document.getElementById("dvMapaZona"),e),google.maps.event.addListener(o.mapZona,"click",function(e){var r=e.latLng.lat(),t=e.latLng.lng(),n=new google.maps.LatLng(r,t),a=new google.maps.Marker({position:n,map:o.mapZona,animation:google.maps.Animation.DROP,title:"Marcador"}),c=new i;c.coordenadas=n,c.marcador=a,o.vecPoligono.push(c),u()})}function u(){for(var e=[],r=0;r<o.vecPoligono.length;r++)e.push(o.vecPoligono[r].coordenadas);null!==o.poly&&o.poly.setMap(null),o.poly=new google.maps.Polygon({paths:e,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25}),o.poly.setMap(o.mapZona)}function d(){for(;o.vecPoligono.length>0;)o.vecPoligono[o.vecPoligono.length-1].marcador.setMap(null),o.vecPoligono.pop();u()}function l(r){var n=e.getPuntos(r);n.then(function(e){if(o.Puntos=e.data,o.Puntos){var r=new google.maps.LatLngBounds,t=0;$.each(o.Puntos,function(e,n){t+=1;var a=new google.maps.LatLng(n.ptLatitud,n.ptLongitud),c=new google.maps.Marker({position:a,map:o.mapZona,animation:google.maps.Animation.DROP,title:"Punto # "+t});r.extend(c.position);var s=new i;s.coordenadas=a,s.marcador=c,o.vecPoligono.push(s)}),u(),o.mapZona.fitBounds(r)}},function(o){t.pop("error","¡Error!",o.data.request),console.log("failure loading Zona",o)})}o.Zonas=[],o.Zona={},o.funcion=null,o.Puntos=[],o.editMode=!1,o.mapZona,o.markerZ=null,o.vecPoligono=new Array,o.poly=null,o.tbZona={},o.title="NUEVA ZONA",o.$parent.SetTitulo("GESTIÓN DE ZONAS"),n(),a(),s(),o.funcion.init(),c(),o.eliminarUltimoPunto=function(){o.vecPoligono.length>0&&(o.vecPoligono[o.vecPoligono.length-1].marcador.setMap(null),o.vecPoligono.pop(),u())},o.nuevo=function(){o.funcion.init(),o.editMode=!1,o.title="NUEVA ZONA"},o.get=function(e){o.funcion.init(),o.editMode=!0,o.title="EDITAR ZONA",o.Zona=e,l(e.znCodigo)},o.guardar=function(){if(o.vecPoligono.length<3)return void t.pop("info","¡Alerta!","Es necesario por lo menos 3 puntos en la región.. Verifique !!");for(var r="",i=[],n="",c=0;c<o.vecPoligono.length;c++){0===c&&(r+=o.vecPoligono[c].coordenadas.lat()+" ",r+=o.vecPoligono[c].coordenadas.lng()),n+=o.vecPoligono[c].coordenadas.lat()+" ",n+=o.vecPoligono[c].coordenadas.lng()+", ";var s={lt:o.vecPoligono[c].coordenadas.lat(),lg:o.vecPoligono[c].coordenadas.lng()};i.push(s)}n+=r;var u,s={znNombre:o.Zona.znNombre.toUpperCase(),znArea:n,znEstado:o.Zona.znEstado,puntos:i};u=o.editMode?e.put(o.Zona.znCodigo,s):e.post(s),u.then(function(e){t.pop("success","¡Información!",e.data.message),o.nuevo(),a()},function(o){t.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})},o.VerEliminar=function(e){o.znCodigo=e,$("#mdConfirmacion").modal("show")},o.eliminar=function(){var r={znCodigo:o.znCodigo};$("#mdConfirmacion").modal("hide");var i=e.delete(o.znCodigo,r);i.then(function(o){t.pop("success","Control de Información",o.data.message),a()},function(o){t.pop("error","¡Error!",o.data.request),console.log("Some Error Occured "+JSON.stringify(o))})}}]);