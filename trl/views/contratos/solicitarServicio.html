<style>
    input{
        text-transform: none;
    }
</style>
<div ng-controller="serviciosController"  class="container-fluid">
    <div class="row">
        <div class="col-xs-12">  
            <div class="tabbable-line">
                <ul class="nav nav-tabs nav-justified" id="tabPanels">
                    <li class="active" > <a href="#tabListado" data-toggle="tab">Asignación de Servicios </a></li>                    
                    <li><a href="#tabRegistro" data-toggle="tab">Nuevo Servicio</a></li>                    
                    <li> <a href="#tabTodos" data-toggle="tab">Listado de Servicios </a></li>
                </ul>
            </div>

            <div class="tab-content">
                <div class="tab-pane" id="tabRegistro">
                    <br/>
                    <div class="row">
                        <div class="col-md-12">
                            <form name="frmServicio" novalidate >
				<div class="panel panel-default">
				    <div class="panel-heading">
					<h3 class="panel-title">Datos del Contrato</h3>
				    </div>
				    <div class="panel-body">

					<div class="col-md-4">
					    <div class="form-group">
						<label  for="txtNumero" >N° Contrato *</label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-sort-numeric-asc text-success"></i></div>
						    <input  type="text" class="form-control" required="" ng-model="Servicio.NumeroContrato" maxlength="11" solo-numeros id="txtNumero" placeholder="Número de Contrato"  >
						    <span class="input-group-btn">
							<button class="btn btn-info btn-md "  type="button"  ng-click="BuscarContrato()" data-toggle="tooltip" data-placement="right" title="Buscar Contrato"><i class=" fa fa-search"></i></button>
						    </span>
						</div> 
					    </div>
					</div>

					<div class="col-md-2">
					    <div class="form-group">
						<label  for="txtCedula" >Identificación </label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-hashtag text-success"></i></div>
						    <input  type="text" class="form-control" required="" ng-model="Servicio.Nit" maxlength="11" solo-numeros id="txtCedula" placeholder="Identificación" disabled >
						</div> 
					    </div>
					</div>

					<div class="col-md-6">
					    <div class="form-group">
						<label for="txtNombre">Nombre Completo </label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-user text-success"></i></div>
						    <input type="text"  class="form-control" required="" ng-model="Servicio.Nombre" maxlength="100" id="txtNombre" placeholder="Nombre Completo" disabled>
						</div>
					    </div>
					</div>                                                                                                   

					<div class="col-md-2">
					    <div class="form-group">
						<label for="txtTelefonoPpal">Teléfono </label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-mobile text-success"></i></div>
						    <input type="text" class="form-control" ng-model="Servicio.Telefono"  required="" maxlength="10" solo-numeros id="txtTelefonoPpal" placeholder="Teléfono" disabled>
						</div>
					    </div>
					</div>

					<div class="col-md-3">
					    <div class="form-group">
						<label for="txtTelefonoPpal">Fecha Inicio</label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-calendar-minus-o text-success"></i></div>
						    <input type="text" class="form-control" ng-model="Servicio.FechaInicio"  required="" maxlength="10" solo-numeros id="txtTelefonoPpal" placeholder="Inicio" disabled>
						</div>
					    </div>
					</div>

					<div class="col-md-3">
					    <div class="form-group">
						<label for="txtTelefonoPpal">Feccha Vencimiento</label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-calendar-times-o text-success"></i></div>
						    <input type="text" class="form-control" ng-model="Servicio.FechaFin"  required="" maxlength="10" solo-numeros id="txtTelefonoPpal" placeholder="F. Final" disabled>
						</div>
					    </div>
					</div>

					<div class="col-md-3">
					    <div class="form-group">
						<label for="txtTelefonoPpal">Estado</label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-check text-success"></i></div>
						    <input type="text" class="form-control" ng-model="Servicio.Estado"  required="" maxlength="10" solo-numeros id="txtTelefonoPpal" placeholder="Estado" disabled>
						</div>
					    </div>
					</div>

					<hr>

					<div class="col-md-8">
					    <div class="form-group">
						<label for="txtResponsable">Responsable del Servicio </label>
						<div class="input-group">    
						    <div class="input-group-addon"><i class="fa fa-user text-success"></i></div>
						    <input type="text"  class="form-control" required="" ng-model="Servicio.Responsable" maxlength="100" id="txtResponsable" placeholder="Responsable del servicio" >
						</div>
					    </div>
					</div>  




				    </div>
				</div>


				<div class="panel panel-default" ng-show="Servicio.TipoServicio.length">
				    <div class="panel-heading">
					<h3 class="panel-title">Seleccionar Servicio</h3>
				    </div>
				    <div class="panel-body">
					<div class="row">
					    <div class="col-md-12">

						<div class="row">                        
						    <div class="col-md-12">
							<div ng-repeat="ts in Servicio.TipoServicio">
							    <div class="col-md-3">     
								<div class="radio radio-danger">                                                                                                    
								    <input type="radio" id="ts{{ts.csCodigo}}" ng-model="Servicio.Tipo" ng-change="TipoServicioCheck()" ng-value="ts">
								    <label for="ts{{ts.csCodigo}}">{{$index + 1}}. &nbsp; {{ts.csDescripcion}}</label>  
								</div>
							    </div> 
							</div>
						    </div>
						</div>

						<hr>


						<div class="row">                                    
						    <div class="col-md-6">
							<div class="form-group">
							    <label  for="txtOrigen">Dirección de origen *</label>     
							    <div class="input-group">  
								<div class="input-group-addon"><i class="fa fa-street-view"></i></div>                                
								<input class="form-control" ng-model="Servicio.Origen"  id="txtOrigen" type="text" required maxlength="255"  placeholder="Ingresa tu ubicación">                                              
							    </div>    
							</div>                                
						    </div>

						    <div class="col-md-6">
							<div class="form-group">
							    <label  for="txtDestino">Dirección de destino *</label>     
							    <div class="input-group">  
								<div class="input-group-addon"><i class="fa fa-globe"></i></div>                                
								<input class="form-control" ng-model="Servicio.Destino"  id="txtDestino" type="text" required maxlength="255"  placeholder="Ingresa tu ubicación">                                              
							    </div>    
							</div>                                
						    </div>
						</div>                                       
					    </div>

					    <div class="col-md-7">
						<div class="row">
						    <div class="col-md-12">
							<div id="dvMapaServicio" style="width: 100%; height: 440px; margin-top: 10px;" ng-model="mapServicio">

							</div>
						    </div>
						</div>
					    </div>
					</div>                                  
				    </div>
				</div>
                            </form>
                        </div>
                    </div>

                </div>

                <div class="tab-pane active" id="tabListado">
                    <br/>
                    <div class="row">
                        <div class="col-md-12">
			    <div class="panel panel-default">
				<div class="panel-heading">Servicios pendientes de asignar</div>
				<div class="panel-body">
				    <div class="row">
					<div class="col-md-6">
					    <div class="input-group">
						<div class="input-group-addon"><i class="fa  fa-search text-primary"></i></div>
						<input  class="form-control" id="search" type="search" placeholder="Buscar Servicio" ng-model="TablaServicio.filter()['busqueda']">
					    </div>

					</div>


					<div class="col-md-2" style="margin-top: 5px;">
					    <label class="text-center text-primary" style="font-size: 18px;">Total: {{Servicios.length}}</label>
					</div>

					<div class="col-md-2">
					    <button type="button" class="btn btn-success btn-addon" ng-click="GetServicios()" ><i class="fa fa-refresh"></i> Actualizar</button>
					</div>
					<br/>
				    </div>
				    <div class="row">
					<div class="col-md-12">
					    <table class="table table-striped table-condensed" ng-table="TablaServicio"  style="margin-top: 15px;">
						<thead>
						    <tr>
							<th>ID</th>
							<th>CONTRATO</th>
							<th>RESPONSABLE</th>
							<th>TELEFONO</th>                                            
							<th>T.SERVICIO</th>
							<th>T.VEHICULO</th>
							<th>$ PRECIO</th>
							<th>FECHA</th>
							<th>HORA</th>
							<th>ESTADO</th>
							<th width="6%">ACCION</th>
						    </tr>
						</thead>

						<tbody>
						    <tr ng-repeat="item in $data"  ng-class="{'info': item.Estado == 'ASIGNADO', 'warning':  item.Estado == 'SOLICITADO' , 'success':  item.Estado != 'SOLICITADO' || item.Estado != 'ASIGNADO'  }">
							<td>{{ item.IdServicio}}</td>
							<td>{{ item.NumeroContrato}}</td>
							<td>{{ item.Responsable}}</td>
							<td >{{ item.Telefono}}</td>
							<td>{{ item.svDescripcion}}</td>
							<td>{{ item.DescVehiculo}}</td>                                     
							<td >{{ item.ValorTotal | currency : "$" : 0}}</td>  
							<td>{{ item.FechaServicio}}</td>
							<td>{{ item.Hora}}</td>                                     
							<td>{{ item.Estado}}</td>
							<td>
						<center>
						    <a ng-click="VerAsignarServicio(item)" style="float: left; margin-left: 3px;" href="javascript:;"  title="Asignar Servicio"><i class="fa fa-check fa-1x text-success"></i></a>
						    <a ng-click="CancelarServicio(item)"  style="float: left; margin-left: 7px;" href="javascript:;"  title="Cancelar"><i class="fa fa-power-off fa-1x text-warning"></i></a>                                            
						</center>
						</td>
						</tr>
						<tr ng-hide="Servicios.length">
						    <td colspan="11" align="center"><h4 class="text-danger"> No se encontraron servicios solicitados.</h4></td>
						</tr> 
						</tbody>
					    </table>
					</div>
				    </div>
				</div>
			    </div>
                        </div>
                    </div>

                    <div class="modal fade bs-example-modal-sm" id="mdAsignar" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" style="margin-top: 1%;">
			<div class="modal-dialog modal-lg" style="width: 70%" >                                   
			    <div class="modal-content">

				<div class="modal-header">
				    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				    <div class="modal-title"> <h3 class="panel-title">Asignación de Servicio N° {{AsigServicio.IdServicio}}  </h3></div>
				</div>

				<div class="modal-body modal-body-fixed">
				    <div class="panel panel-default">
					<div class="panel-body" style="padding-bottom:3px;">
					    <div class="row">
						<div class="col-md-3">
						    <div class="form-group">
							<label  for="txtServiceId" >N° Servicio </label>                                                                                        
							<input  type="text" class="form-control" required="" ng-model="AsigServicio.IdServicio" maxlength="11"  id="txtServiceId" placeholder="N° Servicio" disabled >                                            
						    </div>
						</div>

						<div class="col-md-3">
						    <div class="form-group">
							<label  for="txtCto" >Contrato </label>                                                                                            
							<input  type="text" class="form-control" required="" ng-model="AsigServicio.NumeroContrato" maxlength="11"  id="txtCto" placeholder="N° Contrato" readonly="" >

						    </div>
						</div>

						<div class="col-md-6">
						    <div class="form-group">
							<label  for="txtRespon" >Responsable Servicio </label>                                                                                        
							<input  type="text" class="form-control" required="" ng-model="AsigServicio.Responsable" maxlength="11"  id="txtRespon" placeholder="Responsable Servcio" disabled >                                          
						    </div>
						</div>

						<div class="col-md-3">
						    <div class="form-group">
							<label  for="txtServiceId" >Tipo: &nbsp; </label>                                                                                        
							<label class="text-primary">{{AsigServicio.svDescripcion}}</label>                                                                                 
						    </div>
						</div>

						<div class="col-md-3">
						    <div class="form-group">
							<label  for="txtServiceId" >Tipo Vehiculo : &nbsp; </label>                                                                                        
							<label class="text-primary">{{AsigServicio.DescVehiculo}}</label>                                                                                   
						    </div>
						</div>

						<div class="col-md-4">
						    <div class="form-group">
							<label  for="txtServiceId" >Fecha y Hora: &nbsp; </label>                                                                                        
							<label class="text-primary">{{AsigServicio.FechaServicio}} {{AsigServicio.Hora}}</label> 
						    </div>
						</div>
					    </div>
					</div>
				    </div>   

				    <div class="panel panel-default">
					<div class="panel-heading">
					    <h4 class="panel-title">Seleccionar Conductor</h4>
					</div>
					<div class="panel-body modal-body-fixed" style="padding-bottom:3px;">
					    <div class="row">
						<div class="col-md-12">
						    <table class="table table-striped table-condensed" >
							<thead>
							    <tr>                                                           
								<th>CONDUCTOR</th>                                                            
								<th>TELEFONO</th>                                                                                                        
								<th>DISPOSICIÓN</th>
								<th>PLACA</th>
								<th width="3%">SEL.</th>
							    </tr>
							</thead>
							<tbody>
							    <tr ng-repeat="item in Conductores">
								<td>{{item.Nombre}}</td>
								<td>{{item.TelefonoPpal}}</td>
								<td>{{item.Disposicion}}</td>
								<td>{{item.Placa}}</td>
								<td class="text-center">
								    <div class="radio radio-success" style="margin-top: -1px;">                                        
									<input id="cd{{item.IdConductor}}" type="radio" ng-model="AsigServicio.Conductor"  ng-value="item">
									<label for="cd{{item.IdConductor}}"></label> 
								    </div>
								</td>
							    </tr>
							</tbody>
						    </table>

						</div>
					    </div>
					</div>
				    </div> 

				    <div class="row" ng-show="VerDetalle">
					<div class="col-md-7">
					    <div class="panel panel-default">
						<div class="panel-heading">Responsables</div>
						<table class="table table-striped table-condensed">
						    <thead>
							<tr>					    							    
							    <th>RESPONSABLE</th>
							    <th>TELÉFONO</th>
							    <th>NOTA</th>					   
							</tr>
						    </thead>
						    <tbody>
							<tr ng-repeat="itemc in AsigServicio.Contactos">
							    <td>{{itemc.scNombre}}</td>
							    <td>{{itemc.scTelefono}}</td>
							    <td>{{itemc.scNota}}</td>					    
							</tr>					
						    </tbody>
						</table>
					    </div>
					</div>

					<div class="col-md-5">
					    <div class="panel panel-default">
						<div class="panel-heading">Paradas</div>
						<table class="table table-striped table-condensed">
						    <thead>
							<tr>							    
							    <th>DIRECCIÓN</th>
							    <th>VALOR</th>							    
							</tr>
						    </thead>
						    <tbody>
							<tr ng-repeat="items in AsigServicio.Paradas">							    
							    <td>{{items.prDireccion}}</td>
							    <td>{{items.prValorCliente | currency : "$ " : 0 }}</td>						    
							</tr>
							<tr>
							    <td class="text-right">Total Paradas</td>
							    <td class="text-danger"><strong>{{ AsigServicio.ValorParadas | currency : "$ " : 0}}</strong></td>							   
							</tr>
						    </tbody>
						</table>
					    </div>
					</div>
				    </div>
				</div>

				<div class="modal-footer">
				    <button type="button" class="btn btn-warning btn-addon" title="Ver Detalle de Servicio" ng-click="VerDetalleServicio()"> <i class="fa fa-info"></i>Detalle</button>
				    <button type="button" class="btn btn-danger btn-addon" data-dismiss="modal" title="Cancelar"> <i class="fa fa-ban"></i> Cancelar</button>
				    <button type="button" class="btn btn-primary btn-addon" ng-click="AsignarServicio()" title="Asignar Servicio"><i class="fa fa-check"></i>Asignar</button>
				</div>  

			    </div>

			</div>
		    </div>

                </div>

                <div class="tab-pane" id="tabTodos">
                    <div ng-controller="consultaServiciosController as cs">
			<div class="row">
			    <div class="col-md-12">
				<div class="panel panel-default" style="margin-top: 10px;">
				    <div class="panel-heading">Filtros</div>
				    <div class="panel-body">
					<div class="col-md-3">
					    <div class="form-group">
						<label class="control-label">Por Estado</label>                                       
						<div class="input-group">                            
						    <select ng-model="cs.Filtro.Estado" class="form-control" id="cboEstado"  ng-required="true">
							<option value="TODOS" >TODOS</option>
							<option value="SOLICITADO">SOLICITADO</option>                                    
							<option value="ASIGNADO" >ASIGNADO</option>                                    
							<option value="CANCELADO">CANCELADO</option>
							<option value="CONFIRMADO" >CONFIRMADO</option>                                    
							<option value="DESPLAZAMIENTO A SITIO" >DESPLAZAMIENTO A SITIO</option>
							<option value="EN SITIO">EN SITIO</option>
							<option value="EN RUTA" >EN RUTA</option>                                    
							<option value="FINALIZADO">FINALIZADO</option>
							<option value="RECHAZADO" >RECHAZADO</option>

						    </select>
						</div>   
					    </div>
					</div>                                

					<input type="hidden" id="txtFechaI" ng-model="cs.Filtro.FechaInicial" >
					<input type="hidden" id="txtFechaF" ng-model="cs.Filtro.FechaFin">

					<div class="col-md-4">
					    <div class="form-group">
						<div class="checkbox checkbox-primary" style="margin-top: 0; margin-bottom: 3px;">                                        
						    <input type="checkbox" id="chkFecha"  ng-model="cs.Filtro.FechaChk" ng-true-value="true" ng-false-value="false" >                                         
						    <label for="chkFecha" ><strong>Rango de fechas</strong></label>
						</div> 

						<div class="input-group">                                                                          
						    <div id="reportrange" ng-disabled="cs.Filtro.FechaChk" class="pull-right" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; height: 34px;">
							<i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
							<span></span> <b class="caret"></b>
						    </div>  
						</div>
					    </div>
					</div>   

					<div class="col-md-2">
					    <div class="form-group">
						<label  for="cboTipoServicio">Tipo Servicio</label>
						<div class="input-group">
						    <select ng-model="cs.TipoSelect" class="form-control" id="cboTipoServicio" ng-options="item as item.svDescripcion for item in cs.TipoServicio track by item.svCodigo" ></select>
						</div>
					    </div>
					</div>

					<div class="col-md-2">
					    <div class="form-group">
						<label></label>
						<div class="input-group">      
						    <button type="button" class="btn btn-success btn-addon" ng-click="cs.GetServiciosTodos()" ><i class="fa fa-refresh"></i> Consultar</button>
						</div>
					    </div>

					</div>
				    </div>
				</div>

				<div class="panel panel-default">
				    <div class="panel-heading">Datos</div>
				    <div class="panel-body">
					<div class="col-md-6">

					    <div class="input-group">
						<div class="input-group-addon"><i class="fa  fa-search text-primary"></i></div>
						<input  class="form-control" id="txtsearch" type="text" placeholder="Buscar por N Servcio, Contrato, Nombre, Responsable, Estado" ng-model="cs.TablaTodos.filter()['buscadaAvanzada']">
					    </div>                                                                        

					</div>
					<div class="col-md-3" style="margin-top: 5px;">
					    <label class="text-center text-primary" style="font-size: 18px;">Total Registros: {{cs.ServicioTodos.length}}</label>
					</div>
					<div class="row">
					    <div class="col-md-12">
						<table class="table table-striped table-condensed" ng-table="cs.TablaTodos"  style="margin-top: 15px;">
						    <thead>
							<tr>
							    <th>ID</th>
							    <th>CONTRATO</th>
							    <th>RESPONSABLE</th>
							    <th>TELEFONO</th>                                            
							    <th>T.SERVICIO</th>
							    <th>T.VEHICULO</th>
							    <th>$ VALOR</th>
							    <th>FECHA</th>
							    <th>HORA</th>
							    <th>ESTADO</th>
							    <th width="6%">ACCION</th>
							</tr>
						    </thead>                                            
						    <tbody>
							<tr ng-repeat="item in $data" ng-class="{'info': item.Estado == 'ASIGNADO' || item.Estado == 'CONFIRMADO', 'warning':  item.Estado == 'SOLICITADO', 'success' : item.Estado == 'FINALIZADO', 'danger': item.Estado == 'CANCELADO' } " >
							    <td>{{ item.IdServicio}}</td>
							    <td>{{ item.NumeroContrato}}</td>
							    <td>{{ item.Responsable}}</td>
							    <td >{{ item.Telefono}}</td>
							    <td>{{ item.svDescripcion}}</td>
							    <td>{{ item.DescVehiculo}}</td>                                     
							    <td >{{ item.ValorTotal | currency : "$" : 0}}</td>  
							    <td>{{ item.FechaServicio}}</td>
							    <td>{{ item.Hora}}</td>                                     
							    <td>{{ item.Estado}}</td>
							    <td>
						    <center>                                                
							<!--<a ng-click="CancelarServicio(item)"  style="float: left; margin-left: 7px;" href="javascript:;"  title="Cancelar"><i class="fa fa-power-off fa-1x text-warning"></i></a> -->
						    </center>
						    </td>
						    </tr>
						    <tr ng-hide="cs.ServicioTodos.length">
							<td colspan="11" align="center"><h4 class="text-danger"> No se encontraron servicios con los criterios de busqueda seleccionados.</h4></td>
						    </tr> 
						    </tbody>
						</table>
					    </div>
					</div>
				    </div>
				</div>                                                                       
			    </div>
			</div>
                    </div>
                </div>                                                                
            </div>            
        </div>        
    </div>                    
</div>

<script type="text/javascript">
            //$('#tabPanels a[href="#tabTodos"]').tab('show');

            $('#tabPanels a').click(function (e) {
    e.preventDefault();
            $(this).tab('show');
    });
            $(function () {
            $('[data-toggle="tooltip"]').tooltip();
                    var cb = function(start, end) {
                    $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
                            $('#txtFechaI').val(start.format('YYYY-MM-DD'));
                            $('#txtFechaF').val(end.format('YYYY-MM-DD'));
                    };
                    var optionSet1 = {
                    startDate: moment().subtract(29, 'days'),
                            endDate: moment(),
                            minDate: '01/01/2010',
                            maxDate: '12/31/2030',
                            showDropdowns: true,
                            showWeekNumbers: true,
                            timePicker: false,
                            ranges: {
                            'Hoy': [moment(), moment()],
                                    'Ayer': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                                    'Ultimos 7 dias': [moment().subtract(6, 'days'), moment()],
                                    'Ultimos 30 dias': [moment().subtract(29, 'days'), moment()],
                                    'Este Mes': [moment().startOf('month'), moment().endOf('month')],
                                    'Ultimo Mes': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                            },
                            opens: 'right',
                            buttonClasses: ['btn btn-default'],
                            applyClass: 'btn-sm btn-primary',
                            cancelClass: 'btn-sm btn-warning',
                            format: 'MM/DD/YYYY',
                            separator: ' to ',
                            locale: {
                            applyLabel: 'Aplicar',
                                    cancelLabel: 'Limpiar',
                                    fromLabel: 'Desde',
                                    toLabel: 'Hasta',
                                    customRangeLabel: 'Rango',
                                    daysOfWeek: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sa'],
                                    monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                    firstDay: 1
                            }
                    };
                    $('#reportrange span').html(moment().format('MMMM D, YYYY') + ' - ' + moment().format('MMMM D, YYYY'));
                    $('#reportrange').daterangepicker(optionSet1, cb);
            });



</script>