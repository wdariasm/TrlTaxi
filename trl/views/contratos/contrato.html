<div  ng-controller="contratoController" class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="tabbable-line">
                <ul class="nav nav-tabs nav-justified" id="tabPanels">
                    <li class="active"> <a href="#tabListado" data-toggle="tab">Listado de Contratos </a></li>
                    <li><a href="#tabRegistroCto" data-toggle="tab">{{title}} </a></li>
                </ul>
            </div>
            
            <div class="tab-content">
                
                <div class="tab-pane active" id="tabListado">
                    <br/>
                    <div class="row">
                        <div class="col-xs-6">
                            <label  for="search">Filtro</label>
                             <div class="input-group">
                                 <div class="input-group-addon"><i class="fa  fa-search text-primary"></i></div>
                                 <input  class="form-control" id="search" type="search" placeholder="" ng-model="TablaContrato.filter()['busqueda']">
                             </div>

                        </div>
                         <div class="" style="float:width; margin-top:30px;">
                             <label class=" text-primary" style="font-size: 18px;">Total: {{Contatos.length}}</label>
                         </div>
                        <br/>
                    </div>
                    
                    <table class="table table-striped table-condensed" ng-table="TablaContrato">
                        <thead>
                            <tr>
                                <th>N° CONTRATO</th>
                                <th>IDENTIFICACIÓN</th>
                                <th>NOMBRE</th>
                                <th>TELEFONO</th>
                                <th>F. INICIO</th>                                         
                                <th>F. FINAL</th>                                
                                <th>ESTADO</th>
                                <th width="9%">ACCION</th>
                            </tr>
                        </thead>

                       <tbody>
                            <tr ng-repeat="item in $data">
                                <td>{{ item.ctNumeroContrato}}</td>
                                <td>{{ item.ctNitCliente }}</td>
                                <td >{{ item.ctContratante }}</td>
                                <td>{{ item.ctTelefono}}</td>
                                <td title="Fecha inicio">{{ ConvertirFecha(item.ctFechaInicio) }}</td>
                                <td title="Fecha de finalización">{{ ConvertirFecha(item.ctFechaFinal) }}</td>
                                <td>{{ item.ctEstado}}</td>
                                <td>
                                    <center>
                                        <a ng-click="get(item)" style="float: left; margin-left: 3px;" href="javascript:;"  title="Editar"><i class="fa fa-pencil fa-1x text-success"></i></a>
                                        <a ng-click="VerDesactivar(item.IdVehiculo, 'INACTIVO')"  style="float: left; margin-left: 7px;" href="javascript:;"  title="Eliminar"><i class="fa fa-power-off fa-1x text-warning"></i></a>
                                        <a  ng-click="VerNovedad(item)" style="float: left; margin-left: 7px;" href="javascript:;"  title="Novedades"><i class="fa fa-book text-danger fa-1x"></i></a>
                                    </center>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    
                </div>
                
                <div class="tab-pane" id="tabRegistroCto">  
                    <br>
                    <div class="row">
                        <div class="col-md-12">
                            <form name="frmContrato" novalidate>
                                
                                <div class="row">
                                    <div class="col-md-2 col-md-offset-6">
                                       <button  style="width: 130px"  class="btn btn-success btn-block btn-addon"   type="button"  title="Nuevo / Cancelar" ng-click="Nuevo()"><i class="fa fa-pencil"></i> Nuevo</button>                                                
                                    </div>
                                                                                                                
                                    <div class="col-md-2">
                                        <input type="hidden" required="" ng-model="Contrato.Validar"/>
                                        <div ng-if= "Boton.Guardar = frmContrato.$invalid" ></div>
                                        <button style="width: 130px"   ng-disabled="Boton.Guardar" class="btn btn-primary btn-block btn-addon"   type="button"  title="Registrar Servicio" ng-click="Guardar()"> <i class="fa fa-check"></i>Guardar</button>
                                    </div>
                                    
                                    <div class="col-md-2 " >
                                        <button  style="width: 130px" ng-disabled="Boton.Imprimir" class="btn btn-danger btn-block btn-addon"   type="button"  title="Imprimir Contrato" ><i class="fa fa-file-pdf-o"></i> Imprimir</button>                                                 
                                    </div>
                                   
                                </div>
                                
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h3 class="panel-title" style="display: inline-blockn">Datos Generales</h3>
                                    </div>
                                <div class="panel-body">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label  for="txtCedula" >Identificación *</label>
                                        <div class="input-group">    
                                            <div class="input-group-addon"><i class="fa fa-hashtag text-success"></i></div>
                                                 <input  type="text" class="form-control" required="" ng-model="Contrato.ctNitCliente" maxlength="11" solo-numeros id="txtCedula" placeholder="Identificación" ng-blur="validarIdentificacion()" >
                                        </div> 
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="txtNombre">Nombres *</label>
                                        <div class="input-group">    
                                            <div class="input-group-addon"><i class="fa fa-user text-success"></i></div>
                                            <input type="text"  class="form-control" required="" ng-model="Contrato.ctContratante" maxlength="100" id="txtNombre" placeholder="Nombre Completo">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="txtTelefonoPpal">Teléfono Principal *</label>
                                        <div class="input-group">    
                                            <div class="input-group-addon"><i class="fa fa-mobile text-success"></i></div>
                                            <input type="text" class="form-control" ng-model="Contrato.ctTelefono"  required="" maxlength="10" solo-numeros id="txtTelefonoPpal" placeholder="Teléfono Principal">
                                        </div>
                                   </div>
                               </div>
                                
                                <div class="col-xs-3">
                                    <div class="form-group">
                                        <label  for="txtFechaInicio">Fecha Inicio *</label>
                                        <div class="input-group">
                                            <div class="input-group-addon"><i class="fa fa-calendar-times-o text-success"></i></div>
                                            <input type="text" id="txtFechaInicio" name="txtFechaInicio" ng-model="Contrato.ctFechaInicio" class="form-control" value=""  ng-change="CambiarFormato('ctFechaInicio')">                                                                                            
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-xs-3">
                                    <div class="form-group">
                                        <label  for="txtFechaFin">Fecha Finalización *</label>
                                        <div class="input-group">
                                            <div class="input-group-addon"><i class="fa fa-calendar-times-o text-success"></i></div>
                                            <input type="text" id="txtFechaFin" name="txtFechaFin" ng-model="Contrato.ctFechaFinal" class="form-control" value=""  ng-change="CambiarFormato('ctFechaFinal')">                                                                                            
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="txtDuracion">Duración *</label>
                                        <div class="input-group">    
                                            <div class="input-group-addon"><i class="fa fa-user text-success"></i></div>
                                            <input type="text"  class="form-control" required="" ng-model="Contrato.ctDuracion" maxlength="100" id="txtDuracion" placeholder="Duración contrato">
                                        </div>
                                    </div>
                                </div>
                                    
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label  for="cboTipoContrato">Tipo Contrato *</label>
                                        <div class="input-group">
                                            <div class="input-group-addon"><i class="fa fa-gitlab text-success"></i></div>
                                            <select ng-model="TipoContratoSelect" class="form-control" id="cboTipoContrato" ng-options="item as item.tpDescripcion for item in TipoContrato track by item.IdTipo" required></select>
                                        </div>
                                    </div>
                                </div>
                                    
                                </div>
                                </div>
                                
                                <div class="panel panel-default">
                                    <div class="panel-heading">Servicios y Tarifas</div>
                                    <div class="panel-body">
                                        <div class="row">                        
                                            <div class="col-md-12">
                                                <div ng-repeat="ts in TipoServicio">
                                                    <div class="col-md-3">     
                                                        <div class="checkbox checkbox-primary">                                        
                                                             <input type="checkbox" id="ts{{ts.svCodigo}}" checklist-model="Contrato.TipoServicio" ng-change="TipoServicioCheck(ts)" checklist-value="ts">
                                                             <label for="ts{{ts.svCodigo}}">{{ts.svCodigo}}. &nbsp; {{ts.svDescripcion}}</label> 
                                                        </div>
                                                    </div> 
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <h5 class="text-center text-success" style="margin-bottom: 0px;">{{titlePlantilla}}</h5>
                                        <hr style="margin-top: 1px;">
                                        <div class="row" ng-show="VerPlantilla" >
                                            <div class="col-md-12">                                                
                                                <div ng-repeat="item in Plantillas">
                                                    <div class="col-md-4">     
                                                        <div class="checkbox checkbox-primary">                                        
                                                             <input type="checkbox" id="pl{{item.plCodigo}}" checklist-model="Contrato.Plantillas" ng-change="TipoPlantillaCheck(item,checked)" checklist-value="item">
                                                             <label for="pl{{item.plCodigo}}">{{$index + 1}}. &nbsp; {{item.plDescripcion}}</label> 
                                                        </div>
                                                    </div> 
                                                </div>
                                                
                                               <!-- <table border="0" cellspacing="0" class="table table-striped" >                                                    
                                                    <tbody>
                                                        <tr ng-repeat="items in Plantillas">
                                                            <td class="center">{{ items.plCodigo}}</td>
                                                            <td>{{ items.plDescripcion }}</td>                                                            
                                                            <td>
                                                                <div class="checkbox checkbox-primary" style="margin-top: 0px; margin-bottom: 0px;">                                        
                                                                    <input type="checkbox" id="pll{{items.plCodigo}}" checklist-model="Contrato.Plantillas"  ng-change="TipoPlantillaCheck(items)" checklist-value="items">
                                                                    <label for=""></label> 
                                                                </div>
                                                            </td>                                                            
                                                        </tr>
                                                    </tbody>
                                                </table>-->
                                            </div>
                                        </div>
                                        
                                        <div class="row" ng-hide="VerPlantilla">
                                            <div class="col-md-12">                                                
                                                <div ng-repeat="item in Disponibilidades">
                                                    <div class="col-md-4">     
                                                        <div class="checkbox checkbox-primary">                                        
                                                             <input type="checkbox" id="dp{{item.dpCodigo}}" checklist-model="Contrato.Disponibilidad" ng-change="TipoPlantillaCheck(item,checked)" checklist-value="item">
                                                             <label for="dp{{item.dpCodigo}}">{{$index + 1}}. &nbsp; {{item.dpNombre}}</label> 
                                                        </div>
                                                    </div> 
                                                </div>
                                            </div>    
                                        </div>    
                                    </div>
                                </div>
                                
                                <div class="panel panel-default">
                                    <div class="panel-heading">Forma de Pago</div>
                                    <div class="panel-body">
                                        <div class="row">                        
                                            <div class="col-md-12">
                                                <div ng-repeat="fp in FormaPago">
                                                    <div class="col-md-3">     
                                                        <div class="checkbox checkbox-primary">                                        
                                                             <input type="checkbox" id="fp{{$index}}" checklist-model="Contrato.ctFormaPago"  checklist-value="fp">
                                                             <label for="fp{{$index}}">{{fp}}</label> 
                                                        </div>
                                                    </div> 
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>                                                                                                    
                            </form>
                        </div>                            
                    </div>                    
                </div>
            </div>            
        </div>
    </div>
</div>

<script>
    $('#tabPanels a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
        
    });
    
    $('#tabPanels a[href="#tabRegistroCto"]').tab('show');
    
     $(function() {
        $('input[name="txtFechaInicio"]').daterangepicker({
            singleDatePicker: true,
            showDropdowns: true           
        }, 
        function(start, end, label) {
            $('#txtFechaInicio').val(end.format('DD/MM/YYYY'));         
        });
        
        $('input[name="txtFechaFin"]').daterangepicker({
            singleDatePicker: true,
            showDropdowns: true
        }, 
        function(start, end, label) {
            $('#txtFechaFin').val(end.format('DD/MM/YYYY'));
        });                      
        
    });
    
</script>
